import{_ as we}from"./BBNdmm2W.js";import{h as se,s as te,k as B,a as ie,u as Se,d as pe,z as Ae,A as ge,o as Ue,aP as ze,M as ne,r as v,c as p,b as u,f as n,F as T,q as F,n as I,e as t,w as i,t as h,l as $,v as ue,g as m,y as _e,D as Ce,cd as Ee,m as l,ce as Pe,T as he,Y as Qe,cf as Re,aY as Ie,x as Te,p as $e,bs as Le,cg as Oe,ch as Be,ci as De}from"./tuwxSyZN.js";import{B as Fe}from"./C7Gn6et-.js";import{u as Me}from"./DaeQKk91.js";import{c as de,a as R,d as je,e as ce,f as He}from"./DPQpldFh.js";import{_ as Ke}from"./sgQsKfue.js";import{u as Ne}from"./DJAGGwEC.js";import{u as me}from"./DQN4R622.js";import{u as ke}from"./Mu8HO9gZ.js";import{M as We}from"./Db-A6dMt.js";const le=JSON.parse(`[{"sector":"food","general":{"questions":[{"id":"food-general-1","question":"Vous êtes ?","type":"checkbox","required":true}]},"services":"VOTRE OFFRE","servicesSection":{"questions":[{"id":"food-keywords-1","question":"Quel type de cuisine proposez-vous ?  ","category":"cuisines","type":"checkbox","required":true},{"id":"food-keywords-1","question":"Quel(s) format(s) de prestations assurez-vous ? ","category":"format","type":"checkbox","required":true},{"id":"food-keywords-2","question":"Propositions sucrées : ","category":"sucré","type":"checkbox","required":true},{"id":"food-keywords-3","question":"Propositions salées : ","category":"salé","type":"checkbox","required":true},{"id":"food-keywords-4","question":"Vos options : ","category":"régimes","type":"checkbox","required":true}]},"habitudes":"VOS HABITUDES ","habitudesSection":{"questions":[{"id":"food-keywords-1","question":"Quelles sont vos habitudes en matière d'éco-responsabilité ?  ","category":"écoresp-food","type":"checkbox","required":true}]}},{"sector":"lieux","general":{"questions":[{"id":"lieux-general-1","question":"vous proposez ?","type":"checkbox","required":true}]},"services":"VOTRE OFFRE","servicesSection":{"questions":[{"id":"food-keywords-1","question":"Dans quel environement ? ","category":"environnement","type":"checkbox","required":true},{"id":"food-keywords-2","question":"Mon lieu est accessible : ","category":"accessibilité","type":"checkbox","required":true},{"id":"food-keywords-3","question":"Quelles prestations sont imposées à vos clients ? ","category":"prestations imposées","type":"checkbox","required":true},{"id":"food-keywords-4","question":"Vous proposez une privatisation : ","category":"privatisation","type":"checkbox","required":true},{"id":"food-keywords-4","question":"Quel(s) espaces peuvent-ils y trouver ? ","category":"espaces","type":"checkbox","required":true},{"id":"food-keywords-4","question":"Quels équipements sont à leur disposition ? ","category":"équipements","type":"checkbox","required":true},{"id":"food-keywords-4","question":"Quels options proposez-vous ? ","category":"options","type":"checkbox","required":true}]},"habitudes":"VOS HABITUDES ","habitudesSection":{}},{"sector":"boisson","general":{"questions":[{"id":"boisson-general-1","question":"Vous êtes ?","type":"checkbox","required":true}]},"services":"VOTRE OFFRE","servicesSection":{"questions":[{"id":"food-keywords-1","question":"Quelle boisson proposez-vous ? ","category":"type","type":"checkbox","required":true},{"id":"food-keywords-2","question":"Quel matériel proposez-vous ? ","category":"matériel","type":"checkbox","required":true},{"id":"food-keywords-3","question":"Quels options proposez-vous ? ","category":"options","type":"checkbox","required":true}]},"habitudes":"VOS HABITUDES ","habitudesSection":{}},{"sector":"service","general":{"questions":[{"id":"service-general-1","question":"Vous êtes ?","type":"checkbox","required":true}]},"services":"VOTRE OFFRE","servicesSection":{"questions":[{"id":"service-keywords-1","question":"Quelle(s) préstation(s) proposez-vous ? ","category":"serveur","type":"checkbox","required":true},{"id":"service-keywords-1","question":"Quel(s) matériel(s) fournissez-vous sur une prestation ? ","category":"matériel serveur","type":"checkbox","required":true}]},"habitudes":"VOS HABITUDES ","habitudesSection":{"questions":[{"id":"food-keywords-1","question":"Quelles sont vos habitudes en matière d'éco-responsabilité ?  ","category":"écoresp-food","type":"checkbox","required":true}]}},{"sector":"musique","general":{"questions":[{"id":"musique-general-1","question":"Vous êtes ?","type":"checkbox","required":true}]},"services":"VOTRE OFFRE","servicesSection":{"questions":[{"id":"musique-keywords-1","question":"Quelle service proposez-vous ? ","category":"type","type":"checkbox","required":true},{"id":"musique-keywords-2","question":"Quel matériel proposez-vous ? ","category":"matériel","type":"checkbox","required":true},{"id":"musique-keywords-3","question":"Quels options proposez-vous ? ","category":"options","type":"checkbox","required":true}]},"habitudes":"VOS HABITUDES ","habitudesSection":{"questions":[{"id":"food-keywords-1","question":"Quelles sont vos habitudes en matière d'éco-responsabilité ?  ","category":"écoresp-food","type":"checkbox","required":true}]}},{"sector":"service","general":{"questions":[{"id":"service-general-1","question":"Vous êtes ?","type":"checkbox","required":true}]},"services":"VOTRE OFFRE","servicesSection":{"questions":[{"id":"food-keywords-1","question":"Quelle boisson proposez-vous ? ","category":"type","type":"checkbox","required":true},{"id":"food-keywords-2","question":"Quel matériel proposez-vous ? ","category":"matériel","type":"checkbox","required":true},{"id":"food-keywords-3","question":"Quels options proposez-vous ? ","category":"options","type":"checkbox","required":true}]},"habitudes":"VOS HABITUDES ","habitudesSection":{"questions":[{"id":"food-keywords-1","question":"Quelles sont vos habitudes en matière d'éco-responsabilité ?  ","category":"écoresp-food","type":"checkbox","required":true}]}},{"sector":"boisson","general":{"questions":[{"id":"boisson-general-1","question":"Vous êtes ?","type":"checkbox","required":true}]},"services":"VOTRE OFFRE","servicesSection":{"questions":[{"id":"food-keywords-1","question":"Quelle boisson proposez-vous ? ","category":"type","type":"checkbox","required":true},{"id":"food-keywords-2","question":"Quel matériel proposez-vous ? ","category":"matériel","type":"checkbox","required":true},{"id":"food-keywords-3","question":"Quels options proposez-vous ? ","category":"options","type":"checkbox","required":true}]},"habitudes":"VOS HABITUDES ","habitudesSection":{"questions":[{"id":"food-keywords-1","question":"Quelles sont vos habitudes en matière d'éco-responsabilité ?  ","category":"écoresp-food","type":"checkbox","required":true}]}},{"sector":"boisson","general":{"questions":[{"id":"boisson-general-1","question":"Vous êtes ?","type":"checkbox","required":true}]},"services":"VOTRE OFFRE","servicesSection":{"questions":[{"id":"food-keywords-1","question":"Quelle boisson proposez-vous ? ","category":"type","type":"checkbox","required":true},{"id":"food-keywords-2","question":"Quel matériel proposez-vous ? ","category":"matériel","type":"checkbox","required":true},{"id":"food-keywords-3","question":"Quels options proposez-vous ? ","category":"options","type":"checkbox","required":true}]},"habitudes":"VOS HABITUDES ","habitudesSection":{"questions":[{"id":"food-keywords-1","question":"Quelles sont vos habitudes en matière d'éco-responsabilité ?  ","category":"écoresp-food","type":"checkbox","required":true}]}},{"sector":"boisson","general":{"questions":[{"id":"boisson-general-1","question":"Vous êtes ?","type":"checkbox","required":true}]},"services":"VOTRE OFFRE","servicesSection":{"questions":[{"id":"food-keywords-1","question":"Quelle boisson proposez-vous ? ","category":"type","type":"checkbox","required":true},{"id":"food-keywords-2","question":"Quel matériel proposez-vous ? ","category":"matériel","type":"checkbox","required":true},{"id":"food-keywords-3","question":"Quels options proposez-vous ? ","category":"options","type":"checkbox","required":true}]},"habitudes":"VOS HABITUDES ","habitudesSection":{"questions":[{"id":"food-keywords-1","question":"Quelles sont vos habitudes en matière d'éco-responsabilité ?  ","category":"écoresp-food","type":"checkbox","required":true}]}},{"sector":"boisson","general":{"questions":[{"id":"boisson-general-1","question":"Vous êtes ?","type":"checkbox","required":true}]},"services":"VOTRE OFFRE","servicesSection":{"questions":[{"id":"food-keywords-1","question":"Quelle boisson proposez-vous ? ","category":"type","type":"checkbox","required":true},{"id":"food-keywords-2","question":"Quel matériel proposez-vous ? ","category":"matériel","type":"checkbox","required":true},{"id":"food-keywords-3","question":"Quels options proposez-vous ? ","category":"options","type":"checkbox","required":true}]},"habitudes":"VOS HABITUDES ","habitudesSection":{"questions":[{"id":"food-keywords-1","question":"Quelles sont vos habitudes en matière d'éco-responsabilité ?  ","category":"écoresp-food","type":"checkbox","required":true}]}},{"sector":"boisson","general":{"questions":[{"id":"boisson-general-1","question":"Vous êtes ?","type":"checkbox","required":true}]},"services":"VOTRE OFFRE","servicesSection":{"questions":[{"id":"food-keywords-1","question":"Quelle boisson proposez-vous ? ","category":"type","type":"checkbox","required":true},{"id":"food-keywords-2","question":"Quel matériel proposez-vous ? ","category":"matériel","type":"checkbox","required":true},{"id":"food-keywords-3","question":"Quels options proposez-vous ? ","category":"options","type":"checkbox","required":true}]},"habitudes":"VOS HABITUDES ","habitudesSection":{"questions":[{"id":"food-keywords-1","question":"Quelles sont vos habitudes en matière d'éco-responsabilité ?  ","category":"écoresp-food","type":"checkbox","required":true}]}},{"sector":"boisson","general":{"questions":[{"id":"boisson-general-1","question":"Vous êtes ?","type":"checkbox","required":true}]},"services":"VOTRE OFFRE","servicesSection":{"questions":[{"id":"food-keywords-1","question":"Quelle boisson proposez-vous ? ","category":"type","type":"checkbox","required":true},{"id":"food-keywords-2","question":"Quel matériel proposez-vous ? ","category":"matériel","type":"checkbox","required":true},{"id":"food-keywords-3","question":"Quels options proposez-vous ? ","category":"options","type":"checkbox","required":true}]},"habitudes":"VOS HABITUDES ","habitudesSection":{"questions":[{"id":"food-keywords-1","question":"Quelles sont vos habitudes en matière d'éco-responsabilité ?  ","category":"écoresp-food","type":"checkbox","required":true}]}}]`),Ye=w=>({id:w.id,uuid:w.uuid,sector:w.sector,category:w.category,value:w.value}),ve=()=>{const w=Se(),P=se(),{setProfessionalServices:M,setKeywords:j,setUpdateProfile:L}=P,{professionnalServices:S,keywords:z}=te(P),b=B(!1),D=Ne("token"),O=async k=>{try{b.value=!0;const{data:e}=await ie.get(`${w.public.apiUrl}/sector`,{headers:{Authorization:`Bearer ${D.value}`,"Content-Type":"application/json"}});if(e){const y=e.data.filter(V=>V.name.toLowerCase()===k.toLowerCase());return await Promise.all([K(y[0].uuid),H(y[0].name)]),b.value=!1,{services:S.value,keywords:z.value}}}catch{throw new Error("No data received from API")}},K=async k=>{try{const{data:e}=await ie.get(`${w.public.apiUrl}/service`,{params:{q:k,limit:100},headers:{Authorization:`Bearer ${D.value}`,"Content-Type":"application/json"}});if(e){const y=e.data.filter(V=>V.sectorUuid.toLowerCase()===k.toLowerCase());console.log(y,"data serviceFiltered"),M(y)}}catch{console.error("No data received from API")}},H=async k=>{b.value=!0;try{const{data:e}=await ie.get(`${w.public.apiUrl}/keyword`,{params:{q:k,limit:1e3},headers:{Authorization:`Bearer ${D.value}`,"Content-Type":"application/json"}}),y=e.data.filter(V=>V.sector.toLowerCase()==k.toLowerCase()).slice(0,100).map(V=>Ye(V));j(y),b.value=!1}catch(e){console.error("Error fetching keywords:",e)}};return{loading:b,getKeywords:H,getSectors:O,sendProfessionalServices:async k=>{try{const e=await ie.post(`${w.public.apiUrl}/professional-service/create`,k,{headers:{Authorization:`Bearer ${D.value}`,"Content-Type":"application/json"}});e.data&&(M(e.data),L(!0))}catch(e){console.error("Error sending professional services:",e)}}}},qe=[{label:"Animation (jeux, performeurs, art, bien-être)",value:"animation"},{label:"Beauté (coiffure, maquillage)",value:"beauté"},{label:"Boisson (mixologue, bar mobile, fournisseur...)",value:"boisson"},{label:"Décoration (graphiste, designer, fleuriste, cadeaux...)",value:"décoration"},{label:"Esthétique (soin, sour/cils, manucure, pedicure)",value:"esthétique"},{label:"Humain (coordinateur.trice, officiant.e)",value:"humain"},{label:"Lieux (espace de réception, restaurant, bar...)",value:"lieux"},{label:"Logistique (livraison, sécurité, ménage...)",value:"logistique"},{label:"Look (boutique classique & seconde main)",value:"look"},{label:"Loueur (mobilier, décoration, structure, scéno...)",value:"loueur"},{label:"Musique (dj, musique live)",value:"musique"},{label:"Photo & Vidéo (photographe, vidéaste)",value:"audiovisuel"},{label:"Restauration (traiteur, chef.fe, food-truck...)",value:"food"},{label:"Service (serveur.se, maître d'hotel, hôtesse)",value:"service"},{label:"Transport (véhicule motorisé ou vert, collectif ou individuel)",value:"transport"}],Ge={class:"questionnaires-container"},Je={key:0,class:"mb-6"},Xe={key:1},Ze={class:"text-h6 px-4"},eo={class:"service-chips mt-4"},oo={key:0,class:"mt-6"},so={class:"text-h6 px-4"},to={class:"mt-4"},ro={class:"keyword-chips"},io={key:1,class:"mt-6"},lo={class:"text-h6 px-4"},ao={class:"mt-4"},no={class:"keyword-chips"},uo={key:2,class:"mt-6"},co={class:"text-subtitle-2 mb-2"},po={class:"text-body-2"},mo={key:3,class:"mt-6"},vo={key:0,class:"mb-2"},yo={key:1},fo={class:"mt-1"},bo={key:2,class:"text-center py-8"},go={key:3,class:"text-center py-4"},_o={class:"mt-6 text-center d-flex justify-space-between"},ho=pe({__name:"ServicesPrestataire",props:Ae({sector:{}},{pageActuelle:{},pageActuelleModifiers:{}}),emits:["update:pageActuelle"],setup(w){const P=w,M=ge(w,"pageActuelle"),j=se(),{professionnalServices:L,keywords:S,professionalUser:z}=te(j),{getSectors:b,sendProfessionalServices:D}=ve(),{addSuccess:O,addError:K}=ke(),{patchProfessionnalProfileDetails:H}=me(),A=B([]),k=B(qe),e=B([]),y=()=>{M.value=M.value-1},V=()=>Math.random().toString(36).substr(2,9),N=(r,o)=>{var f;return((f=o.find(c=>c.uuid===r))==null?void 0:f.name)||"Service inconnu"},W=(r,o)=>{for(const f in o){const c=o[f].find(x=>x.uuid===r);if(c)return c.value}return"Mot-clé inconnu"},Z=r=>{for(const o of A.value){const f=o.services.find(c=>c.uuid===r);if(f)return f.name}return"Service inconnu"},G=r=>{const o=[];for(const f of A.value)for(const c of r){const x=W(c,f.keywordsByCategory);x!=="Mot-clé inconnu"&&o.push(x)}return[...new Set(o)]},J=(r,o)=>{var x,a,Q;if(!r||!((x=S.value)!=null&&x.length))return{};const f={},c=[];return r.servicesSection&&c.push(...((a=r.servicesSection.questions)==null?void 0:a.map(q=>q.category))||[]),r.habitudesSection&&c.push(...((Q=r.habitudesSection.questions)==null?void 0:Q.map(q=>q.category))||[]),c.forEach(q=>{f[q]=S.value.filter(oe=>oe.category===q&&(oe.sector.toLowerCase()===o.toLowerCase()||!oe.sector))}),f},Y=r=>{const o=le.find(f=>f.sector.toLowerCase()===r.toLowerCase());return{id:V(),sector:r,questionnaireData:o,services:[...L.value||[]],keywordsByCategory:J(o,r),selectedServiceUuid:null,selectedKeywords:new Set}},C=(r,o)=>{o.selectedServiceUuid===r.uuid?o.selectedServiceUuid=null:o.selectedServiceUuid=r.uuid,X()},s=(r,o)=>{o.selectedKeywords.has(r.uuid)?o.selectedKeywords.delete(r.uuid):o.selectedKeywords.add(r.uuid),X()},_=async(r,o)=>{if(!o)return;r.questionnaireData=null,r.services=[],r.keywordsByCategory={},r.selectedServiceUuid=null,r.selectedKeywords.clear(),await b(o);const f=ne([L,S],([c,x])=>{if(c!=null&&c.length&&(x!=null&&x.length)){const a=le.find(Q=>Q.sector.toLowerCase()===o.toLowerCase());r.sector=o,r.questionnaireData=a,r.services=[...c],r.keywordsByCategory=J(a,o),f()}},{immediate:!0})},E=()=>{const r={id:V(),sector:"",questionnaireData:null,services:[],keywordsByCategory:{},selectedServiceUuid:null,selectedKeywords:new Set};A.value.push(r)},X=()=>{e.value=[],A.value.forEach(r=>{var o;r.selectedServiceUuid&&((o=z.value)!=null&&o.uuid)&&e.value.push({serviceUuid:r.selectedServiceUuid,professionalUuid:z.value.uuid,keywordsUuid:Array.from(r.selectedKeywords)})})},ee=async()=>{if(e.value.length===0){K({message:"Aucun service sélectionné"});return}try{const r=e.value.map(o=>D(o));await Promise.all(r),e.value.length>=2&&await H({...z.value,secondActivity:le[1].sector??"",thirdActivity:le[2].sector??""}),O({message:`${e.value.length} service(s) créé(s) avec succès !`})}catch(r){console.error("Erreur lors de l'envoi:",r),K({message:"Erreur lors de l'envoi des services"})}};return Ue(async()=>{if(P.sector&&P.sector!=="Veuillez choisir votre activité")try{await b(P.sector),await ze();const r=ne([L,S],([o,f])=>{if(o!=null&&o.length&&(f!=null&&f.length)&&A.value.length===0){const c=Y(P.sector);A.value.push(c),r()}},{immediate:!0})}catch(r){console.error("Erreur lors du chargement initial:",r)}}),ne([L,S],()=>{var r,o;if((r=L.value)!=null&&r.length&&((o=S.value)!=null&&o.length)&&P.sector&&A.value.length===0){const f=Y(P.sector);A.value.push(f)}},{immediate:!0}),(r,o)=>{const f=v("v-select"),c=v("v-divider"),x=v("v-chip"),a=v("v-expansion-panel-text"),Q=v("v-expansion-panel"),q=v("v-expansion-panels"),oe=v("v-icon"),ye=v("v-card-title"),fe=v("v-card-text"),be=v("v-card"),xe=v("v-progress-circular"),ae=v("v-btn");return u(),p("div",Ge,[(u(!0),p(T,null,F(A.value,(d,re)=>(u(),p("div",{key:d.id,class:"questionnaire-section mb-8"},[re>0?(u(),p("div",Je,[t(f,{label:`Votre ${re+1}ème activité ?`,modelValue:d.sector,"onUpdate:modelValue":[g=>d.sector=g,g=>_(d,g)],items:k.value,"item-title":"label","item-value":"value",variant:"outlined"},null,8,["label","modelValue","onUpdate:modelValue","items"])])):I("",!0),d.questionnaireData&&d.services.length>0?(u(),p("div",Xe,[t(c,{class:"mt-6"},{default:i(()=>[n("span",Ze,h(d.questionnaireData.general.questions[0].question),1)]),_:2},1024),n("div",eo,[(u(!0),p(T,null,F(d.services,g=>(u(),$(x,{key:g.uuid,variant:"outlined",color:d.selectedServiceUuid===g.uuid?"primary":"default",class:ue(["ma-1",{"selected-chip":d.selectedServiceUuid===g.uuid}]),onClick:U=>C(g,d)},{default:i(()=>[m(h(g.name),1)]),_:2},1032,["color","onClick","class"]))),128))]),d.questionnaireData.servicesSection?(u(),p("div",oo,[t(c,null,{default:i(()=>[n("span",so,h(d.questionnaireData.servicesSection.title||"Services détaillés"),1)]),_:2},1024),n("div",to,[t(q,{variant:"accordion",multiple:""},{default:i(()=>[(u(!0),p(T,null,F(d.questionnaireData.servicesSection.questions,g=>(u(),$(Q,{key:g.category,title:g.question},{default:i(()=>[t(a,null,{default:i(()=>[n("div",ro,[(u(!0),p(T,null,F(d.keywordsByCategory[g.category]||[],U=>(u(),$(x,{key:U.uuid,variant:"outlined",class:ue(["ma-1",{"selected-chip":d.selectedKeywords.has(U.uuid)}]),color:d.selectedKeywords.has(U.uuid)?"success":"default",onClick:Ve=>s(U,d)},{default:i(()=>[m(h(U.value),1)]),_:2},1032,["color","onClick","class"]))),128))])]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:2},1024)])])):I("",!0),d.questionnaireData.habitudesSection?(u(),p("div",io,[t(c,null,{default:i(()=>[n("span",lo,h(d.questionnaireData.habitudesSection.title||"Habitudes et pratiques"),1)]),_:2},1024),n("div",ao,[t(q,{variant:"accordion",multiple:""},{default:i(()=>[(u(!0),p(T,null,F(d.questionnaireData.habitudesSection.questions,g=>(u(),$(Q,{key:g.category,title:g.question},{default:i(()=>[t(a,null,{default:i(()=>[n("div",no,[(u(!0),p(T,null,F(d.keywordsByCategory[g.category]||[],U=>(u(),$(x,{key:U.uuid,variant:"outlined",class:ue(["ma-1",{"selected-chip":d.selectedKeywords.has(U.uuid)}]),color:d.selectedKeywords.has(U.uuid)?"success":"default",onClick:Ve=>s(U,d)},{default:i(()=>[m(h(U.value),1)]),_:2},1032,["color","onClick","class"]))),128))])]),_:2},1024)]),_:2},1032,["title"]))),128))]),_:2},1024)])])):I("",!0),e.value.length>0?(u(),p("div",uo,[t(be,{variant:"outlined",color:"success"},{default:i(()=>[t(ye,{class:"text-h6 d-flex align-center"},{default:i(()=>[t(oe,{class:"mr-2"},{default:i(()=>o[2]||(o[2]=[m("mdi-check-circle",-1)])),_:1,__:[2]}),m(" Services prêts à être envoyés ("+h(e.value.length)+") ",1)]),_:1}),t(fe,null,{default:i(()=>[(u(!0),p(T,null,F(e.value,(g,U)=>(u(),p("div",{key:U,class:"mb-3 pa-3 bg-grey-lighten-5 rounded"},[n("div",co,"Questionnaire "+h(U+1),1),n("div",po,[o[3]||(o[3]=n("strong",null,"Service:",-1)),m(" "+h(Z(g.serviceUuid)),1),o[4]||(o[4]=n("br",null,null,-1)),o[5]||(o[5]=n("strong",null,"Professional UUID:",-1)),m(" "+h(g.professionalUuid),1),o[6]||(o[6]=n("br",null,null,-1)),n("strong",null,"Mots-clés ("+h(g.keywordsUuid.length)+"):",1),m(" "+h(G([g.keywordsUuid]).join(", ")),1)])]))),128))]),_:2},1024)]),_:2},1024)])):I("",!0),d.selectedServiceUuid||d.selectedKeywords.size>0?(u(),p("div",mo,[t(be,{variant:"outlined",class:"pa-4"},{default:i(()=>[t(ye,{class:"text-subtitle-1"},{default:i(()=>o[7]||(o[7]=[m("Résumé de vos sélections",-1)])),_:1,__:[7]}),t(fe,null,{default:i(()=>[d.selectedServiceUuid?(u(),p("div",vo,[o[8]||(o[8]=n("strong",null,"Service sélectionné :",-1)),m(" "+h(N(d.selectedServiceUuid,d.services)),1)])):I("",!0),d.selectedKeywords.size>0?(u(),p("div",yo,[n("strong",null,"Mots-clés sélectionnés ("+h(d.selectedKeywords.size)+") :",1),n("div",fo,[(u(!0),p(T,null,F(Array.from(d.selectedKeywords),g=>(u(),$(x,{key:g,size:"small",color:"success",class:"ma-1"},{default:i(()=>[m(h(W(g,d.keywordsByCategory)),1)]),_:2},1024))),128))])])):I("",!0)]),_:2},1024)]),_:2},1024)])):I("",!0)])):re===0?(u(),p("div",bo,[t(xe,{indeterminate:"",color:"primary",class:"mb-4"}),o[9]||(o[9]=n("p",null,"Chargement des services et mots-clés...",-1))])):re>0&&!d.sector?(u(),p("div",go,o[10]||(o[10]=[n("p",{class:"text-grey"}," Sélectionnez un secteur d'activité pour afficher les services disponibles ",-1)]))):I("",!0)]))),128)),n("div",_o,[A.value.length<3?(u(),$(ae,{key:0,onClick:E,color:"primary",variant:"outlined","prepend-icon":"mdi-plus"},{default:i(()=>o[11]||(o[11]=[m(" Ajouter une nouvelle activité ",-1)])),_:1,__:[11]})):I("",!0)]),n("div",null,[t(ae,{onClick:o[0]||(o[0]=d=>y())},{default:i(()=>o[12]||(o[12]=[m("Retour",-1)])),_:1,__:[12]}),t(ae,{color:"primary",onClick:o[1]||(o[1]=d=>ee())},{default:i(()=>o[13]||(o[13]=[m("Valider ma selection",-1)])),_:1,__:[13]})])])}}}),ko=_e(ho,[["__scopeId","data-v-53c5c28c"]]),qo=[{label:"Auvergne Rhône-Alpes",value:"rhoneAlpes"},{label:"Ain",value:"ain"},{label:"Allier",value:"allier"},{label:"Ardèche",value:"ardeche"},{label:"Cantal",value:"cantal"},{label:"Drôme",value:"drome"},{label:"Haute-Savoie",value:"hauteSavoie"},{label:"Haute Loire",value:"hauteLoire"},{label:"Isère",value:"isere"},{label:"Loire",value:"loire"},{label:"Puy De Dôme",value:"puyDeDome"},{label:"Rhône",value:"rhone"},{label:"Savoie",value:"savoie"}],xo={class:"d-flex gap-2 flex-column justify-start align-items-start"},Vo={class:"d-flex align-center gap-2"},wo={class:"mt-4"},So={class:"my-8"},Ao={key:1,class:"d-flex justify-space-between"},Uo=pe({__name:"EditProfessionalProfil",props:{openModal:{type:Boolean},openModalModifiers:{}},emits:["update:openModal"],setup(w){var Y;const P=se(),{createProfessionalProfile:M}=me(),{getSectors:j}=ve(),{isProfileCreated:L}=te(P),S=ge(w,"openModal"),z=B([]),b=B(!1),{addError:D}=ke(),O=B(1),K=B(qe),H=B(qo),A=Ce(()=>z.value.reduce((C,s)=>(s.question&&s.reponse&&(C[s.question]=s.reponse),C),{})),k=de({name:R().min(2).required("Le nom est requis"),siret:R().required("Le SIRET est requis").length(14,"Le SIRET doit contenir 14 caractères"),address:R().required("L'adresse est requise"),bio:R().required("La bio est requise"),mainActivity:R().required("Activité requise"),mainInterlocutor:R().required("L'interlocuteur principal est requis"),experience:ce().min(0,"L'expérience doit être positive").required("L'expérience est requise"),geographicArea:R().required("La zone géographique est requise"),certification:R(),minimumReservationPeriod:ce().min(0,"La période de réservation doit être positive"),deposit:He(),depositAmount:ce().min(0,"Le montant de l'acompte doit être positif"),billingPeriod:R().required("La période de facturation est requise"),links:je().of(de({type:R(),value:R().url("URL non valide")})),faq:de({question:R(),reponse:R()})}),{values:e,errors:y,resetForm:V}=Me({validationSchema:k,initialValues:{name:"",siret:"",address:"",bio:"",mainActivity:"Veuillez choisir votre activité",mainInterlocutor:"",experience:0,geographicArea:((Y=H.value[0])==null?void 0:Y.label)??"",faq:{},minimumReservationPeriod:0,certification:"",deposit:!1,depositAmount:0,billingPeriod:"beforeEvent",links:[]},validateOnMount:!1,keepValuesOnUnmount:!0}),N=()=>{e.links.push({type:"",value:""})},W=C=>{e.links.length>0&&e.links.splice(C,1)},Z=()=>{z.value.push({question:"",reponse:""})},G=C=>{z.value.length>=0&&z.value.splice(C,1)},J=async C=>{const s={...C,faq:A.value,minimumReservationPeriod:C.minimumReservationPeriod*7};try{(await M(s)).message==="Professional created"?(j(e.mainActivity),O.value=2):D({message:"La mise à jour du profil a échoué."})}catch{D({message:"Erreur lors de la mise à jour du profil."})}};return V(),(C,s)=>{const _=v("v-divider"),E=v("v-text-field"),X=v("v-select"),ee=v("v-number-input"),r=v("v-checkbox"),o=v("v-label"),f=v("v-switch"),c=v("v-btn"),x=v("v-form");return u(),p(T,null,[t(Fe,{modelValue:S.value,"onUpdate:modelValue":s[16]||(s[16]=a=>S.value=a),fullscreen:"",transition:"dialog-bottom-transition"},{title:i(()=>[m(h(l(L)?"Modifier votre profil":"Renseignez votre profil"),1)]),content:i(()=>[t(x,{class:"px-4"},{default:i(()=>[Ee(n("div",null,[t(_,{class:"mt-6"},{default:i(()=>s[17]||(s[17]=[n("p",{class:"mt-6"},null,-1),m(" A propos de votre entreprise",-1)])),_:1,__:[17]}),t(E,{class:"mt-6",label:"Le nom de votre entreprise ?",modelValue:l(e).name,"onUpdate:modelValue":s[0]||(s[0]=a=>l(e).name=a),"error-messages":b.value?l(y).name:void 0},null,8,["modelValue","error-messages"]),t(E,{label:"Votre Numéro De Siret ?",modelValue:l(e).siret,"onUpdate:modelValue":s[1]||(s[1]=a=>l(e).siret=a),"error-messages":b.value?l(y).siret:void 0},null,8,["modelValue","error-messages"]),t(E,{label:"L'adresse complète du siège social ?",modelValue:l(e).address,"onUpdate:modelValue":s[2]||(s[2]=a=>l(e).address=a),"error-messages":b.value?l(y).address:void 0},null,8,["modelValue","error-messages"]),t(E,{label:"Une courte description de votre activité ?",modelValue:l(e).bio,"onUpdate:modelValue":s[3]||(s[3]=a=>l(e).bio=a),"error-messages":b.value?l(y).bio:void 0},null,8,["modelValue","error-messages"]),t(X,{label:"Votre activité principale ?",modelValue:l(e).mainActivity,"onUpdate:modelValue":s[4]||(s[4]=a=>l(e).mainActivity=a),items:K.value,"item-title":"label","item-value":"value","error-messages":b.value?l(y).mainActivity:void 0},null,8,["modelValue","items","error-messages"]),t(E,{label:"Le nom complet de l'interlocuteur principal ?",modelValue:l(e).mainInterlocutor,"onUpdate:modelValue":s[5]||(s[5]=a=>l(e).mainInterlocutor=a),"error-messages":b.value?l(y).mainInterlocutor:void 0},null,8,["modelValue","error-messages"]),t(ee,{label:"Depuis combien d'année exercez-vous cette activité ?",modelValue:l(e).experience,"onUpdate:modelValue":s[6]||(s[6]=a=>l(e).experience=a),variant:"solo",min:0,"error-messages":b.value?l(y).experience:void 0},null,8,["modelValue","error-messages"]),t(_,{class:"border-opacity-50 mb-6"},{default:i(()=>s[18]||(s[18]=[n("p",{class:"mb-6"},"A propos de votre activité",-1)])),_:1,__:[18]}),t(X,{label:"Votre secteur géographique ?",modelValue:l(e).geographicArea,"onUpdate:modelValue":s[7]||(s[7]=a=>l(e).geographicArea=a),items:H.value,"item-title":"label","item-value":"value","error-messages":b.value?l(y).geographicArea:void 0},null,8,["modelValue","items","error-messages"]),t(E,{modelValue:l(e).certification,"onUpdate:modelValue":s[8]||(s[8]=a=>l(e).certification=a),label:"Labels & Certifications",variant:"outlined",placeholder:"exemple: Label AB (Bio)"},null,8,["modelValue"]),t(ee,{variant:"solo",min:0,label:"Votre délai de réservation minimum (en semaine) ?",modelValue:l(e).minimumReservationPeriod,"onUpdate:modelValue":s[9]||(s[9]=a=>l(e).minimumReservationPeriod=a),"error-messages":b.value?l(y).minimumReservationPeriod:void 0},null,8,["modelValue","error-messages"]),t(r,{label:"Doit-on vous faire un accompte avant prestation",modelValue:l(e).deposit,"onUpdate:modelValue":s[10]||(s[10]=a=>l(e).deposit=a),"error-messages":b.value?l(y).deposit:void 0},null,8,["modelValue","error-messages"]),l(e).deposit?(u(),$(ee,{key:0,variant:"solo",min:0,max:100,step:5,label:"Quel est le montant de dépôt (en pourcentage)?",modelValue:l(e).depositAmount,"onUpdate:modelValue":s[11]||(s[11]=a=>l(e).depositAmount=a),"error-messages":b.value?l(y).depositAmount:void 0},null,8,["modelValue","error-messages"])):I("",!0),n("div",xo,[t(o,{class:"text-subtitle-1 font-weight-medium"},{default:i(()=>s[19]||(s[19]=[m("Vous souhaitez être payer avant l'évènement ?",-1)])),_:1,__:[19]}),n("div",Vo,[t(o,{class:"text-subtitle-1 font-weight-medium"},{default:i(()=>s[20]||(s[20]=[m("Avant la prestation",-1)])),_:1,__:[20]}),t(f,{modelValue:l(e).billingPeriod,"onUpdate:modelValue":s[12]||(s[12]=a=>l(e).billingPeriod=a),"false-value":"beforeEvent","true-value":"afterEvent",color:l(e).billingPeriod==="beforeEvent"?"success":"primary","hide-details":"","error-messages":b.value?l(y).billingPeriod:void 0},{default:i(()=>[m(h(l(e).billingPeriod),1)]),_:1},8,["modelValue","color","error-messages"]),t(o,{class:"text-subtitle-1 font-weight-medium"},{default:i(()=>s[21]||(s[21]=[m("Après la prestation",-1)])),_:1,__:[21]})])]),t(_,{class:"mb-6"},{default:i(()=>s[22]||(s[22]=[n("p",{class:"mb-6"},"A propos de votre communication",-1)])),_:1,__:[22]}),n("div",wo,[(u(!0),p(T,null,F(l(e).links,(a,Q)=>(u(),p("div",{key:Q},[t(X,{modelValue:a.type,"onUpdate:modelValue":q=>a.type=q,label:"Renseignez le réseau social ou le site web",items:["Facebook","Instagram","LinkedIn","Twitter","Site Web"],"item-title":"label","item-value":"value"},null,8,["modelValue","onUpdate:modelValue"]),t(E,{modelValue:a.value,"onUpdate:modelValue":q=>a.value=q,label:"Renseignez le lien vers le réseau social ou le site web",type:"url",variant:"outlined",placeholder:"https://www.example.com/mon-reseau-social"},null,8,["modelValue","onUpdate:modelValue"]),t(c,{onClick:q=>W(Q),disabled:l(e).links.length<=0,color:"error","prepend-icon":"mdi-delete",size:"small",class:"mb-4"},{default:i(()=>s[23]||(s[23]=[m(" Supprimer ",-1)])),_:2,__:[23]},1032,["onClick","disabled"])]))),128)),t(c,{onClick:N,color:"primary"},{default:i(()=>s[24]||(s[24]=[m(" Ajouter un lien vers un réseau social ou un site web ",-1)])),_:1,__:[24]})]),n("div",So,[(u(!0),p(T,null,F(z.value,(a,Q)=>(u(),p("div",{key:Q},[t(E,{modelValue:a.question,"onUpdate:modelValue":q=>a.question=q,label:"Renseignez une question fréquente auquelle vous répondez souvent","item-title":"label","item-value":"value"},null,8,["modelValue","onUpdate:modelValue"]),t(E,{modelValue:a.reponse,"onUpdate:modelValue":q=>a.reponse=q,label:"Renseignez la réponse à la question",type:"text",variant:"outlined",placeholder:"https://www.example.com/mon-reseau-social"},null,8,["modelValue","onUpdate:modelValue"]),t(c,{onClick:q=>G(Q),disabled:z.value.length===0,color:"error","prepend-icon":"mdi-delete",size:"small",class:"my-2"},{default:i(()=>s[25]||(s[25]=[m(" Supprimer ",-1)])),_:2,__:[25]},1032,["onClick","disabled"])]))),128)),t(c,{onClick:Z,color:"primary"},{default:i(()=>s[26]||(s[26]=[m(" Ajouter une question fréquente et sa réponse ",-1)])),_:1,__:[26]})])],512),[[Pe,O.value===1]]),O.value===2?(u(),$(ko,{key:0,class:"mt-6",sector:l(e).mainActivity,pageActuelle:O.value,"onUpdate:pageActuelle":s[13]||(s[13]=a=>O.value=a)},null,8,["sector","pageActuelle"])):I("",!0),O.value===1?(u(),p("div",Ao,[t(c,{onClick:s[14]||(s[14]=a=>S.value=!1)},{default:i(()=>s[27]||(s[27]=[m("Annuler",-1)])),_:1,__:[27]}),t(c,{color:"primary",onClick:s[15]||(s[15]=a=>J(l(e)))},{default:i(()=>s[28]||(s[28]=[m("Vers le questionnaire détaillé",-1)])),_:1,__:[28]})])):I("",!0)]),_:1})]),_:1},8,["modelValue"]),(u(),$(he,{to:"body"},[t(Ke)]))],64)}}}),zo={class:"position-relative"},Co=["src"],Eo={class:"mx-sm-5"},Po={class:"d-sm-flex align-center justify-sm-start justify-center"},Qo={class:"text-sm-left text-center"},Ro=["src"],Io={class:"ml-sm-4 text-sm-left text-center"},To={class:"text-h3 font-weight-semibold mb-1 my-sm-0 my-2"},$o={class:"text-h6 font-weight-medium text-grey100"},Lo={class:"d-flex flex-column justify-center align-center gap-4"},Oo={key:0},Bo={class:"d-sm-flex d-none"},Do=pe({__name:"ProfileBannerOne",setup(w){const{bgPicture:P}=te(se()),M=B(null),j=B(!1),L=B(null),{user:S,isProfileCreated:z,isProfilUpdate:b}=te(se());ve();const{changeProfessionalBannerPicture:D}=me(),O=()=>{var k;return(k=L.value)==null?void 0:k.click()},K=async k=>{var V;const e=k.target;if(!((V=e.files)!=null&&V.length))return;const y=e.files[0];await D(y)},H=Qe([{tab:"My Profile",icon:Le,href:"/apps/userprofile/one"},{tab:"Teams",icon:Oe,href:"/apps/userprofile/one/teams"},{tab:"Projects",icon:Be,href:"/apps/userprofile/one/projects"},{tab:"Connection",icon:De,href:"/apps/userprofile/one/connection"}]),A=()=>{j.value=!j.value};return(k,e)=>{const y=v("v-avatar"),V=v("v-chip"),N=v("v-col"),W=v("v-btn"),Z=we,G=v("v-row"),J=v("v-tab"),Y=v("v-tabs"),C=v("v-card-item"),s=v("v-card");return u(),p(T,null,[n("div",zo,[n("img",{src:l(P),alt:"profile",class:"w-100"},null,8,Co),n("button",{onClick:O,class:"profile-banner__change-image"},"+"),n("input",{type:"file",ref_key:"fileInput",ref:L,onChange:K,accept:"image/*",style:{display:"none"}},null,544)]),n("div",Eo,[t(s,{elevation:"10",class:"overflow-hidden mt-sm-n13 mt-n5"},{default:i(()=>[t(C,{class:"pb-0"},{default:i(()=>[t(G,{class:"mt-1 justify-space-between"},{default:i(()=>[t(N,{cols:"12",md:"6",sm:"9",class:"pt-0"},{default:i(()=>{var _,E;return[n("div",Po,[n("div",Qo,[t(y,{size:"100",class:"userImage position-relative overflow-visible"},{default:i(()=>[n("img",{src:l(Re),width:"100",alt:"Mathew",class:"rounded-circle"},null,8,Ro),t(y,{size:"26",class:"bg-primary position-absolute plus"},{default:i(()=>[t(l(Ie),{size:"16","stroke-width":"2"})]),_:1})]),_:1})]),n("div",Io,[n("h5",To,[m(h(((_=l(S))==null?void 0:_.username)??"Définir votre nom complet")+" ",1),t(V,{color:"primary",class:"bg-lightprimary font-weight-semibold ml-2 mt-n1",variant:"outlined",size:"x-small"},{default:i(()=>e[4]||(e[4]=[m("Admin",-1)])),_:1,__:[4]})]),n("span",$o,h(((E=l(S))==null?void 0:E.category)??"Aucune phrase inspirante définie"),1)])])]}),_:1}),t(N,{cols:"12",md:"6",sm:"3",class:"d-flex align-center justify-center justify-sm-end order-sm-third"},{default:i(()=>[n("div",Lo,[n("div",null,[t(W,{color:"primary",size:"large",class:"w-100",onClick:e[0]||(e[0]=_=>A())},{default:i(()=>e[5]||(e[5]=[m("Editez votre profil",-1)])),_:1,__:[5]})]),l(z)?(u(),p("div",Oo,[t(Z,{to:"/dashboards/dashboard2",class:"w-100"},{default:i(()=>[t(W,{color:"success",size:"large",class:"w-100"},{default:i(()=>e[6]||(e[6]=[m(" Revenir à votre dashboard ",-1)])),_:1,__:[6]})]),_:1})])):I("",!0)])]),_:1})]),_:1}),t(G,null,{default:i(()=>[t(N,{md:"12",class:"profile-one"},{default:i(()=>[t(Y,{modelValue:M.value,"onUpdate:modelValue":e[1]||(e[1]=_=>M.value=_),color:"primary",dark:"",class:"profiletab"},{default:i(()=>[(u(!0),p(T,null,F(H.value,_=>(u(),$(J,{key:_.tab,to:_.href,class:"text-grey100 mr-sm-3"},{default:i(()=>[(u(),$(Te(_.icon),{size:"20","stroke-width":"1.5",class:"mr-sm-2 text-h6 text-grey100 icon"})),n("span",Bo,h(_.tab),1)]),_:2},1032,["to"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),(u(),$(he,{to:"body"},[t(Uo,{openModal:j.value,"onUpdate:openModal":e[2]||(e[2]=_=>j.value=_)},null,8,["openModal"]),t(We,{redirection:"dashboard2",modelValue:l(b),"onUpdate:modelValue":e[3]||(e[3]=_=>$e(b)?b.value=_:null)},null,8,["modelValue"])]))],64)}}}),Xo=_e(Do,[["__scopeId","data-v-55241871"]]);export{Xo as P};
