import{h as g,s as h,k as C,a as c,u as k}from"./DkNnpBgi.js";import{u as S}from"./kkF_28Ko.js";import{u as P}from"./BKs1zNTn.js";const A=o=>({id:o.id,uuid:o.uuid,sector:o.sector,category:o.category,value:o.value,isSelected:!1}),T=()=>{const o=k(),l=g(),{setProfessionalServices:u,setKeywords:p,setUpdateProfile:f}=l,{professionnalServices:v,keywords:y}=h(l),a=C(!1),i=S("token"),n=P(),w=async r=>{try{a.value=!0;const e=await(n==null?void 0:n.get(`${o.public.apiUrl}/sector`));if(console.log(e,"Response from sectors API"),e){const s=e.data.data.filter(t=>t.name.toLowerCase()===r.toLowerCase());return await Promise.all([m(s[0].uuid),d(s[0].name)]),a.value=!1,{services:v.value,keywords:y.value}}}catch{throw new Error("No data received from API")}},m=async r=>{try{const e=await c.get(`${o.public.apiUrl}/service`,{params:{q:r,limit:100},headers:{Authorization:`Bearer ${i.value}`,"Content-Type":"application/json"}});if(e){const s=e.data.data.filter(t=>t.sectorUuid.toLowerCase()===r.toLowerCase());u(s)}}catch{console.error("No data received from API")}},d=async r=>{a.value=!0;try{const e=await c.get(`${o.public.apiUrl}/keyword`,{params:{q:r,limit:1e3},headers:{Authorization:`Bearer ${i.value}`,"Content-Type":"application/json"}});if(e){const s=e.data.data.filter(t=>t.sector.toLowerCase()==r.toLowerCase()).slice(0,100).map(t=>A(t));console.log(s,"Keywords fetched and filtered"),p(s),a.value=!1}}catch(e){console.error("Error fetching keywords:",e)}};return{loading:a,getKeywords:d,getSectors:w,sendProfessionalServices:async r=>{try{const e=await c.post(`${o.public.apiUrl}/professional-service/create`,r,{headers:{Authorization:`Bearer ${i.value}`,"Content-Type":"application/json"}});e.data&&(u(e.data),f(!0))}catch(e){console.error("Error sending professional services:",e)}}}};export{T as u};
