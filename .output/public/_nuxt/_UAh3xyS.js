import{d as K,cb as le,cc as H,r as n,c as I,a as f,F as z,b as t,g as q,h as N,w as a,J as T,f as p,e as d,x as ae,i as Q,c3 as J,at as ne,s as Y,l as L,A as re,u as o,G as ie,t as R,p as G,L as ue,U as de,cd as me,aW as pe,v as ve,n as ce,bq as fe,ce as _e,cf as be,cg as ge}from"./CHEumwGj.js";import{a as Ve}from"./DRO4nZRS.js";import{c as W,a as V,d as ye,e as j,f as ke}from"./C6eScHbE.js";import{u as Z}from"./CjAgQoew.js";import{u as Ue}from"./BqfPwIYT.js";const we={class:"overlay-content"},xe=K({__name:"BaseModal",props:le({fullscreen:{type:Boolean,default:!1},transition:{default:"dialog-bottom-transition"},showOverlay:{type:Boolean,default:!0},showCloseButton:{type:Boolean,default:!0}},{modelValue:{type:Boolean},modelModifiers:{}}),emits:["update:modelValue"],setup(w){const y=H(w,"modelValue");return(i,g)=>{const U=n("v-card-title"),v=n("v-card-text"),u=n("v-card-actions"),m=n("v-icon"),c=n("v-btn"),A=n("v-card"),s=n("v-dialog"),r=n("v-overlay");return f(),I(z,null,[t(s,{class:"modal-dialog",modelValue:y.value,"onUpdate:modelValue":g[1]||(g[1]=$=>y.value=$),fullscreen:i.fullscreen,transition:i.transition},{default:a(()=>[t(A,{class:"modal-card"},{default:a(()=>[i.$slots.title?(f(),q(U,{key:0,class:"modal-title"},{default:a(()=>[T(i.$slots,"title",{},void 0,!0)]),_:3})):N("",!0),t(v,{class:"modal-content"},{default:a(()=>[T(i.$slots,"content",{},void 0,!0)]),_:3}),i.$slots.actions?(f(),q(u,{key:1,class:"modal-actions"},{default:a(()=>[T(i.$slots,"actions",{},void 0,!0)]),_:3})):N("",!0),t(c,{class:"modal-close-button",icon:"",onClick:g[0]||(g[0]=$=>y.value=!1)},{default:a(()=>[t(m,null,{default:a(()=>g[2]||(g[2]=[p("mdi-close",-1)])),_:1,__:[2]})]),_:1})]),_:3})]),_:3},8,["modelValue","fullscreen","transition"]),i.showOverlay?(f(),q(r,{key:0,value:y.value,class:"modal-overlay"},{default:a(()=>[d("div",we,[T(i.$slots,"overlay-content",{},void 0,!0)])]),_:3},8,["value"])):N("",!0)],64)}}}),qe=ae(xe,[["__scopeId","data-v-5777c89b"]]),Ae=()=>{const{addError:w,addSuccess:y}=Z(),i=Ue("token"),g=Q(),{setProfessionalUser:U}=g,v=ne(),u=async c=>{try{if(console.log(v.public.tokenSiret,"Token SIRET:",c.siret,"Professional SIRET"),(await J.get(`https://api.insee.fr/api-sirene/3.11/siret/${c.siret}`,{headers:{accept:"application/json","X-INSEE-Api-Key-Integration":v.public.tokenSiret}})).data)try{console.log("SIRET is valid, proceeding with profile update..."),console.log(i.value,"Token:",i,"Professional Token");const{data:r}=await J.post(`${v.public.apiUrl}/professional/create`,c,{headers:{Authorization:`Bearer ${i.value}`,"Content-Type":"application/json"}});if(r)return y("Inscription réussie, veuillez vérifier votre email pour confirmer votre compte."),m(),r}catch{w({message:"Veuillez vérifier que le SIRET soit valide."})}}catch{w({message:"Une erreur est survenue lors de la mise à jour du profil."})}},m=async()=>{try{const{data:c}=await J.get(`${v.public.apiUrl}/professional`,{headers:{Authorization:`Bearer ${i.value}`,"Content-Type":"application/json"}});if(c)return U(c),c}catch{w({message:"Une erreur est survenue lors de la récupération du profil."})}};return{updateProfessionalProfile:u,getUserProfile:m}},$e={class:"d-flex gap-2 flex-column justify-start align-items-start"},Pe={class:"d-flex align-center gap-2"},Ie={class:"mt-4"},Se={class:"my-8"},Ce=K({__name:"EditUserProfil",props:{openModal:{type:Boolean},openModalModifiers:{}},emits:["update:openModal"],setup(w){const y=Q(),{updateProfessionalProfile:i}=Ae(),{isProfessionalProfileCreated:g}=Y(y),U=H(w,"openModal"),v=L([]),u=L(!1),{addError:m}=Z(),c=re(()=>v.value.reduce((b,e)=>(e.question&&e.reponse&&(b[e.question]=e.reponse),b),{})),A=W({name:V().min(2).required("Le nom est requis"),siret:V().required("Le SIRET est requis").length(14,"Le SIRET doit contenir 14 caractères"),address:V().required("L'adresse est requise"),bio:V().required("La bio est requise"),mainActivity:V().required("Activité requise"),mainInterlocutor:V().required("L'interlocuteur principal est requis"),experience:j().min(0,"L'expérience doit être positive").required("L'expérience est requise"),geographicArea:V().required("La zone géographique est requise"),minimumBenefit:j().min(0,"Le bénéfice minimum doit être positif"),minimumReservationPeriod:j().min(0,"La période de réservation doit être positive"),deposit:ke(),depositAmount:j().min(0,"Le montant de l'acompte doit être positif"),billingPeriod:V().required("La période de facturation est requise"),links:ye().of(W({type:V(),value:V().url("URL non valide")})),faq:W({question:V(),reponse:V()})}),{values:s,errors:r,handleSubmit:$,resetForm:h}=Ve({validationSchema:A,initialValues:{name:"",firstName:"",lastName:"",siret:"",address:"",bio:"",mainActivity:"Locations",mainInterlocutor:"",experience:0,geographicArea:"",faq:{},minimumBenefit:0,minimumReservationPeriod:0,deposit:!1,depositAmount:0,billingPeriod:"beforeEvent",links:[]},validateOnMount:!1,keepValuesOnUnmount:!0}),B=$(b=>{const e={...b,faq:c.value};i(e),h(),U.value=!1},({errors:b,values:e})=>{m({message:JSON.stringify(b)})}),D=b=>{var e,S;((e=s.links)==null?void 0:e.length)>=0&&((S=s.links)==null||S.splice(b,1))},F=b=>{v.value.length>=0&&v.value.splice(b,1)},_=L([{label:"Locations",value:"espaces & lieux"},{label:"Alimentation et Boissons",value:"food & beverage"},{label:"Audiovisuel",value:"audio & visuel"},{label:"Artistique",value:"artistique"},{label:"Logistique",value:"logistique"},{label:"Divertissement",value:"animations"},{label:"Soins",value:"soin & bien-être"}]);return(b,e)=>{const S=n("v-divider"),k=n("v-text-field"),X=n("v-select"),M=n("v-number-input"),ee=n("v-checkbox"),O=n("v-label"),oe=n("v-switch"),C=n("v-btn"),te=n("v-form"),se=n("v-spacer");return f(),q(qe,{modelValue:U.value,"onUpdate:modelValue":e[19]||(e[19]=l=>U.value=l),fullscreen:"",transition:"dialog-bottom-transition"},{title:a(()=>[p(R(o(g)?"Modifier votre profil":"Renseignez votre profil"),1)]),content:a(()=>[t(te,{onSubmit:e[17]||(e[17]=ie(l=>o(B)(),["prevent"])),class:"px-4"},{default:a(()=>[t(S,{class:"mt-6"},{default:a(()=>e[20]||(e[20]=[d("p",{class:"mt-6"},null,-1),p(" A propos de votre entreprise",-1)])),_:1,__:[20]}),t(k,{class:"mt-6",label:"Votre Raison Sociale",modelValue:o(s).name,"onUpdate:modelValue":e[0]||(e[0]=l=>o(s).name=l),"error-messages":u.value?o(r).name:void 0},null,8,["modelValue","error-messages"]),t(k,{class:"mt-6",label:"Votre Prénom",modelValue:o(s).firstName,"onUpdate:modelValue":e[1]||(e[1]=l=>o(s).firstName=l),"error-messages":u.value?o(r).name:void 0},null,8,["modelValue","error-messages"]),t(k,{class:"mt-6",label:"Votre nom",modelValue:o(s).lastName,"onUpdate:modelValue":e[2]||(e[2]=l=>o(s).lastName=l),"error-messages":u.value?o(r).name:void 0},null,8,["modelValue","error-messages"]),t(k,{label:"Votre Numéro De Siret",modelValue:o(s).siret,"onUpdate:modelValue":e[3]||(e[3]=l=>o(s).siret=l),"error-messages":u.value?o(r).siret:void 0},null,8,["modelValue","error-messages"]),t(k,{label:"Votre Adresse",modelValue:o(s).address,"onUpdate:modelValue":e[4]||(e[4]=l=>o(s).address=l),"error-messages":u.value?o(r).address:void 0},null,8,["modelValue","error-messages"]),t(k,{label:"Votre Bio",modelValue:o(s).bio,"onUpdate:modelValue":e[5]||(e[5]=l=>o(s).bio=l),"error-messages":u.value?o(r).bio:void 0},null,8,["modelValue","error-messages"]),t(X,{label:"Votre Activité Principale",modelValue:o(s).mainActivity,"onUpdate:modelValue":e[6]||(e[6]=l=>o(s).mainActivity=l),items:_.value,"item-title":"label","item-value":"value","error-messages":u.value?o(r).mainActivity:void 0},null,8,["modelValue","items","error-messages"]),t(k,{label:"Le nom complet de l'interlocuteur principal",modelValue:o(s).mainInterlocutor,"onUpdate:modelValue":e[7]||(e[7]=l=>o(s).mainInterlocutor=l),"error-messages":u.value?o(r).mainInterlocutor:void 0},null,8,["modelValue","error-messages"]),t(M,{label:"Depuis combien d'année vous avez cette activité ?",modelValue:o(s).experience,"onUpdate:modelValue":e[8]||(e[8]=l=>o(s).experience=l),variant:"solo",min:0,"error-messages":u.value?o(r).experience:void 0},null,8,["modelValue","error-messages"]),t(S,{class:"border-opacity-50 mb-6"},{default:a(()=>e[21]||(e[21]=[d("p",{class:"mb-6"},"A propos de votre activité",-1)])),_:1,__:[21]}),t(k,{label:"Votre zone d'activité",modelValue:o(s).geographicArea,"onUpdate:modelValue":e[9]||(e[9]=l=>o(s).geographicArea=l),"error-messages":u.value?o(r).geographicArea:void 0},null,8,["modelValue","error-messages"]),t(M,{label:"Votre tarif minimum",variant:"solo",min:0,modelValue:o(s).minimumBenefit,"onUpdate:modelValue":e[10]||(e[10]=l=>o(s).minimumBenefit=l),"error-messages":u.value?o(r).minimumBenefit:void 0},null,8,["modelValue","error-messages"]),t(M,{variant:"solo",min:0,max:30,step:1,label:"votre nombre de jour(s) minimum pour valider une réservation ?",modelValue:o(s).minimumReservationPeriod,"onUpdate:modelValue":e[11]||(e[11]=l=>o(s).minimumReservationPeriod=l),"error-messages":u.value?o(r).minimumReservationPeriod:void 0},null,8,["modelValue","error-messages"]),t(ee,{label:"Doit-on vous faire un accompte avant presation",modelValue:o(s).deposit,"onUpdate:modelValue":e[12]||(e[12]=l=>o(s).deposit=l),"error-messages":u.value?o(r).deposit:void 0},null,8,["modelValue","error-messages"]),o(s).deposit?(f(),q(M,{key:0,variant:"solo",min:0,max:100,step:5,label:"Quel est le montant de dépôt (en pourcentage)?",modelValue:o(s).depositAmount,"onUpdate:modelValue":e[13]||(e[13]=l=>o(s).depositAmount=l),"error-messages":u.value?o(r).depositAmount:void 0},null,8,["modelValue","error-messages"])):N("",!0),d("div",$e,[t(O,{class:"text-subtitle-1 font-weight-medium"},{default:a(()=>e[22]||(e[22]=[p("Vous souhaitez être payer avant l'évènement ?",-1)])),_:1,__:[22]}),d("div",Pe,[t(O,{class:"text-subtitle-1 font-weight-medium"},{default:a(()=>e[23]||(e[23]=[p("Avant la prestation",-1)])),_:1,__:[23]}),t(oe,{modelValue:o(s).billingPeriod,"onUpdate:modelValue":e[14]||(e[14]=l=>o(s).billingPeriod=l),"false-value":"beforeEvent","true-value":"afterEvent",color:o(s).billingPeriod==="beforeEvent"?"success":"primary","hide-details":"","error-messages":u.value?o(r).billingPeriod:void 0},{default:a(()=>[p(R(o(s).billingPeriod),1)]),_:1},8,["modelValue","color","error-messages"]),t(O,{class:"text-subtitle-1 font-weight-medium"},{default:a(()=>e[24]||(e[24]=[p("Après la prestation",-1)])),_:1,__:[24]})])]),t(S,{class:"mb-6"},{default:a(()=>e[25]||(e[25]=[d("p",{class:"mb-6"},"A propos de votre communication",-1)])),_:1,__:[25]}),d("div",Ie,[(f(!0),I(z,null,G(o(s).links,(l,x)=>{var P;return f(),I("div",{key:x},[t(X,{modelValue:l.type,"onUpdate:modelValue":E=>l.type=E,label:"Renseignez le réseau social ou le site web",items:["Facebook","Instagram","LinkedIn","Twitter","Site Web"],"item-title":"label","item-value":"value"},null,8,["modelValue","onUpdate:modelValue"]),t(k,{modelValue:l.value,"onUpdate:modelValue":E=>l.value=E,label:"Renseignez le lien vers le réseau social ou le site web",type:"text",variant:"outlined",placeholder:"https://www.example.com/mon-reseau-social"},null,8,["modelValue","onUpdate:modelValue"]),t(C,{onClick:E=>D(x),disabled:((P=o(s).links)==null?void 0:P.length)===0,color:"error","prepend-icon":"mdi-delete",size:"small",class:"mb-4"},{default:a(()=>e[26]||(e[26]=[p(" Supprimer ",-1)])),_:2,__:[26]},1032,["onClick","disabled"])])}),128)),t(C,{onClick:e[15]||(e[15]=l=>{var x;return(x=o(s).links)==null?void 0:x.push({type:"",value:""})}),color:"primary","prepend-icon":"mdi-plus"},{default:a(()=>e[27]||(e[27]=[p(" Ajouter un lien vers un réseau social ou un site web ",-1)])),_:1,__:[27]})]),d("div",Se,[(f(!0),I(z,null,G(v.value,(l,x)=>(f(),I("div",{key:x},[t(k,{modelValue:l.question,"onUpdate:modelValue":P=>l.question=P,label:"Renseignez une question fréquente auquelle vous répondez souvent","item-title":"label","item-value":"value"},null,8,["modelValue","onUpdate:modelValue"]),t(k,{modelValue:l.reponse,"onUpdate:modelValue":P=>l.reponse=P,label:"Renseignez la réponse à la question",type:"text",variant:"outlined",placeholder:"https://www.example.com/mon-reseau-social"},null,8,["modelValue","onUpdate:modelValue"]),t(C,{onClick:P=>F(x),disabled:v.value.length===0,color:"error","prepend-icon":"mdi-delete",size:"small",class:"my-2"},{default:a(()=>e[28]||(e[28]=[p(" Supprimer ",-1)])),_:2,__:[28]},1032,["onClick","disabled"])]))),128)),t(C,{onClick:e[16]||(e[16]=l=>v.value.push({question:"",reponse:""})),color:"primary","prepend-icon":"mdi-plus"},{default:a(()=>e[29]||(e[29]=[p(" Ajouter une question fréquente et sa réponse ",-1)])),_:1,__:[29]})])]),_:1})]),actions:a(()=>[t(se),t(C,{onClick:e[18]||(e[18]=l=>U.value=!1)},{default:a(()=>e[30]||(e[30]=[p("Annuler",-1)])),_:1,__:[30]}),t(C,{color:"primary",onClick:o(B)},{default:a(()=>e[31]||(e[31]=[p("Enregistrer",-1)])),_:1,__:[31]},8,["onClick"])]),_:1},8,["modelValue"])}}}),Le=ue("/images/backgrounds/profilebg-2.jpg"),Re=["src"],ze={class:"mx-sm-5"},Be={class:"d-sm-flex align-center justify-sm-start justify-center"},Me={class:"text-sm-left text-center"},Ee=["src"],Te={class:"ml-sm-4 text-sm-left text-center"},je={class:"text-h3 font-weight-semibold mb-1 my-sm-0 my-2"},Ne={class:"text-h6 font-weight-medium text-grey100"},he={class:""},De={class:"d-sm-flex d-none"},Ke=K({__name:"ProfileBannerOne",setup(w){const y=L(null),i=L(!1),{user:g}=Y(Q()),U=de([{tab:"My Profile",icon:fe,href:"/apps/userprofile/one"},{tab:"Teams",icon:_e,href:"/apps/userprofile/one/teams"},{tab:"Projects",icon:be,href:"/apps/userprofile/one/projects"},{tab:"Connection",icon:ge,href:"/apps/userprofile/one/connection"}]),v=()=>{i.value=!i.value};return(u,m)=>{const c=n("v-avatar"),A=n("v-chip"),s=n("v-col"),r=n("v-btn"),$=n("v-row"),h=n("v-tab"),B=n("v-tabs"),D=n("v-card-item"),F=n("v-card");return f(),I(z,null,[d("img",{src:o(Le),alt:"profile",class:"w-100"},null,8,Re),d("div",ze,[t(F,{elevation:"10",class:"overflow-hidden mt-sm-n13 mt-n5"},{default:a(()=>[t(D,{class:"pb-0"},{default:a(()=>[t($,{class:"mt-1 justify-space-between"},{default:a(()=>[t(s,{cols:"12",md:"6",sm:"9",class:"pt-0"},{default:a(()=>{var _,b;return[d("div",Be,[d("div",Me,[t(c,{size:"100",class:"userImage position-relative overflow-visible"},{default:a(()=>[d("img",{src:o(me),width:"100",alt:"Mathew",class:"rounded-circle"},null,8,Ee),t(c,{size:"26",class:"bg-primary position-absolute plus"},{default:a(()=>[t(o(pe),{size:"16","stroke-width":"2"})]),_:1})]),_:1})]),d("div",Te,[d("h5",je,[p(R(((_=o(g))==null?void 0:_.name)??"Définir votre nom complet")+" ",1),t(A,{color:"primary",class:"bg-lightprimary font-weight-semibold ml-2 mt-n1",variant:"outlined",size:"x-small"},{default:a(()=>m[3]||(m[3]=[p("Admin",-1)])),_:1,__:[3]})]),d("span",Ne,R(((b=o(g))==null?void 0:b.phraseInspirante)??"Aucune phrase inspirante définie"),1)])])]}),_:1}),t(s,{cols:"12",md:"6",sm:"3",class:"d-flex align-center justify-center justify-sm-end order-sm-third"},{default:a(()=>[d("div",he,[t(r,{color:"primary",size:"large",onClick:m[0]||(m[0]=_=>v())},{default:a(()=>m[4]||(m[4]=[p("Editez votre profil",-1)])),_:1,__:[4]})])]),_:1})]),_:1}),t($,null,{default:a(()=>[t(s,{md:"12",class:"profile-one"},{default:a(()=>[t(B,{modelValue:y.value,"onUpdate:modelValue":m[1]||(m[1]=_=>y.value=_),color:"primary",dark:"",class:"profiletab"},{default:a(()=>[(f(!0),I(z,null,G(U.value,_=>(f(),q(h,{key:_.tab,to:_.href,class:"text-grey100 mr-sm-3"},{default:a(()=>[(f(),q(ve(_.icon),{size:"20","stroke-width":"1.5",class:"mr-sm-2 text-h6 text-grey100 icon"})),d("span",De,R(_.tab),1)]),_:2},1032,["to"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1})]),(f(),q(ce,{to:"body"},[t(Ce,{openModal:i.value,"onUpdate:openModal":m[2]||(m[2]=_=>i.value=_)},null,8,["openModal"])]))],64)}}});export{Ke as _};
