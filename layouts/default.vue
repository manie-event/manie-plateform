<script setup lang="ts">
import { useCustomizerStore } from '@/stores/customizer';
import { useProfessionalProfile } from '~/composables/professional-user/UseProfessionalProfile';
import { UserCategory } from '~/models/enums/userCategoryEnums';

const title = ref('Manie');

const customizer = useCustomizerStore();
const { getProfessionalProfileDetails } = useProfessionalProfile();
const { user } = storeToRefs(useUserStore());

useHead({
  meta: [{ content: title }],
  titleTemplate: (titleChunk) => {
    return titleChunk
      ? `${titleChunk} - Nuxt3 Typescript based Admin Dashboard Template`
      : 'Spikeadmin - Nuxt3 Typescript based Admin Dashboard Template';
  },
});

onMounted(async () => {
  if (user.value?.category === UserCategory.PRESTA) {
    await getProfessionalProfileDetails();
  }
});
</script>

<template>
  <!-----RTL LAYOUT------->
  <v-locale-provider v-if="customizer.setRTLLayout" rtl>
    <v-app :theme="customizer.actTheme" :class="customizer.actTheme">
      <!---Customizer location left side--->
      <ClientOnly>
        <!-- <LcFullVerticalSidebar v-if="!customizer.setHorizontalLayout" /> -->
        <div :class="customizer.boxed ? 'maxWidth' : 'full-header'">
          <LcFullVerticalHeader v-if="!customizer.setHorizontalLayout" />
        </div>
        <div :class="customizer.boxed ? 'maxWidth' : 'full-header'">
          <LcFullHorizontalHeader v-if="customizer.setHorizontalLayout" />
        </div>
        <LcFullHorizontalSidebar v-if="customizer.setHorizontalLayout" />
      </ClientOnly>
      <v-main>
        <div class="rtl-lyt">
          <v-container fluid class="px-sm-5 px-4 rounded-xl">
            <div class="">
              <div :class="customizer.boxed ? 'maxWidth' : ''">
                <NuxtPage />
                <v-btn
                  class="customizer-btn"
                  size="large"
                  icon
                  variant="flat"
                  color="primary"
                  @click.stop="customizer.SET_CUSTOMIZER_DRAWER(!customizer.Customizer_drawer)"
                >
                  <SettingsIcon />
                </v-btn>
              </div>
            </div>
          </v-container>
        </div>
      </v-main>
    </v-app>
  </v-locale-provider>

  <!-----LTR LAYOUT------->
  <v-locale-provider v-else>
    <v-app :theme="customizer.actTheme" :class="customizer.actTheme">
      <!---Customizer location right side--->
      <ClientOnly>
        <LcFullVerticalSidebar v-if="!customizer.setHorizontalLayout" />
        <div>
          <LcFullVerticalHeader v-if="!customizer.setHorizontalLayout" />
        </div>
        <div :class="customizer.boxed ? 'maxWidth' : 'full-header'">
          <LcFullHorizontalHeader v-if="customizer.setHorizontalLayout" />
        </div>
        <LcFullHorizontalSidebar v-if="customizer.setHorizontalLayout" />
      </ClientOnly>
      <v-main>
        <div>
          <v-container class="dashboard-position">
            <div class="">
              <div :class="customizer.boxed ? 'maxWidth' : ''">
                <NuxtPage />
                <v-btn
                  class="customizer-btn"
                  size="large"
                  icon
                  variant="flat"
                  color="primary"
                  @click.stop="customizer.SET_CUSTOMIZER_DRAWER(!customizer.Customizer_drawer)"
                >
                  <SettingsIcon />
                </v-btn>
              </div>
            </div>
          </v-container>
        </div>
      </v-main>
    </v-app>
  </v-locale-provider>
</template>
<style lang="scss" scoped>
.dashboard-position {
  display: flex;
  height: 100vh;
  align-items: center;
}
</style>
