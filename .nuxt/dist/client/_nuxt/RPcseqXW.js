import{b4 as I,l as A,b5 as k,Z as N,b6 as D,aW as _,a2 as B,aD as z,x as w,aL as $}from"./aI3ctD-H.js";function K(e,i){if(typeof e!="string")throw new TypeError("argument str must be a string");const n={},t=i||{},r=t.decode||H;let a=0;for(;a<e.length;){const o=e.indexOf("=",a);if(o===-1)break;let s=e.indexOf(";",a);if(s===-1)s=e.length;else if(s<o){a=e.lastIndexOf(";",o-1)+1;continue}const u=e.slice(a,o).trim();if(t!=null&&t.filter&&!(t!=null&&t.filter(u))){a=s+1;continue}if(n[u]===void 0){let c=e.slice(o+1,s).trim();c.codePointAt(0)===34&&(c=c.slice(1,-1)),n[u]=V(c,r)}a=s+1}return n}function H(e){return e.includes("%")?decodeURIComponent(e):e}function V(e,i){try{return i(e)}catch{return e}}const b=/^[\u0009\u0020-\u007E\u0080-\u00FF]+$/;function T(e,i,n){const t=n||{},r=t.encode||encodeURIComponent;if(typeof r!="function")throw new TypeError("option encode is invalid");if(!b.test(e))throw new TypeError("argument name is invalid");const a=r(i);if(a&&!b.test(a))throw new TypeError("argument val is invalid");let o=e+"="+a;if(t.maxAge!==void 0&&t.maxAge!==null){const s=t.maxAge-0;if(Number.isNaN(s)||!Number.isFinite(s))throw new TypeError("option maxAge is invalid");o+="; Max-Age="+Math.floor(s)}if(t.domain){if(!b.test(t.domain))throw new TypeError("option domain is invalid");o+="; Domain="+t.domain}if(t.path){if(!b.test(t.path))throw new TypeError("option path is invalid");o+="; Path="+t.path}if(t.expires){if(!J(t.expires)||Number.isNaN(t.expires.valueOf()))throw new TypeError("option expires is invalid");o+="; Expires="+t.expires.toUTCString()}if(t.httpOnly&&(o+="; HttpOnly"),t.secure&&(o+="; Secure"),t.priority)switch(typeof t.priority=="string"?t.priority.toLowerCase():t.priority){case"low":{o+="; Priority=Low";break}case"medium":{o+="; Priority=Medium";break}case"high":{o+="; Priority=High";break}default:throw new TypeError("option priority is invalid")}if(t.sameSite)switch(typeof t.sameSite=="string"?t.sameSite.toLowerCase():t.sameSite){case!0:{o+="; SameSite=Strict";break}case"lax":{o+="; SameSite=Lax";break}case"strict":{o+="; SameSite=Strict";break}case"none":{o+="; SameSite=None";break}default:throw new TypeError("option sameSite is invalid")}return t.partitioned&&(o+="; Partitioned"),o}function J(e){return Object.prototype.toString.call(e)==="[object Date]"||e instanceof Date}const x=Object.freeze({ignoreUnknown:!1,respectType:!1,respectFunctionNames:!1,respectFunctionProperties:!1,unorderedObjects:!0,unorderedArrays:!1,unorderedSets:!1,excludeKeys:void 0,excludeValues:void 0,replacer:void 0});function C(e,i){i?i={...x,...i}:i=x;const n=M(i);return n.dispatch(e),n.toString()}const q=Object.freeze(["prototype","__proto__","constructor"]);function M(e){let i="",n=new Map;const t=r=>{i+=r};return{toString(){return i},getContext(){return n},dispatch(r){return e.replacer&&(r=e.replacer(r)),this[r===null?"null":typeof r](r)},object(r){if(r&&typeof r.toJSON=="function")return this.object(r.toJSON());const a=Object.prototype.toString.call(r);let o="";const s=a.length;s<10?o="unknown:["+a+"]":o=a.slice(8,s-1),o=o.toLowerCase();let u=null;if((u=n.get(r))===void 0)n.set(r,n.size);else return this.dispatch("[CIRCULAR:"+u+"]");if(typeof Buffer<"u"&&Buffer.isBuffer&&Buffer.isBuffer(r))return t("buffer:"),t(r.toString("utf8"));if(o!=="object"&&o!=="function"&&o!=="asyncfunction")this[o]?this[o](r):e.ignoreUnknown||this.unkown(r,o);else{let c=Object.keys(r);e.unorderedObjects&&(c=c.sort());let l=[];e.respectType!==!1&&!L(r)&&(l=q),e.excludeKeys&&(c=c.filter(f=>!e.excludeKeys(f)),l=l.filter(f=>!e.excludeKeys(f))),t("object:"+(c.length+l.length)+":");const d=f=>{this.dispatch(f),t(":"),e.excludeValues||this.dispatch(r[f]),t(",")};for(const f of c)d(f);for(const f of l)d(f)}},array(r,a){if(a=a===void 0?e.unorderedArrays!==!1:a,t("array:"+r.length+":"),!a||r.length<=1){for(const u of r)this.dispatch(u);return}const o=new Map,s=r.map(u=>{const c=M(e);c.dispatch(u);for(const[l,d]of c.getContext())o.set(l,d);return c.toString()});return n=o,s.sort(),this.array(s,!1)},date(r){return t("date:"+r.toJSON())},symbol(r){return t("symbol:"+r.toString())},unkown(r,a){if(t(a),!!r&&(t(":"),r&&typeof r.entries=="function"))return this.array(Array.from(r.entries()),!0)},error(r){return t("error:"+r.toString())},boolean(r){return t("bool:"+r)},string(r){t("string:"+r.length+":"),t(r)},function(r){t("fn:"),L(r)?this.dispatch("[native]"):this.dispatch(r.toString()),e.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(r.name)),e.respectFunctionProperties&&this.object(r)},number(r){return t("number:"+r)},xml(r){return t("xml:"+r.toString())},null(){return t("Null")},undefined(){return t("Undefined")},regexp(r){return t("regex:"+r.toString())},uint8array(r){return t("uint8array:"),this.dispatch(Array.prototype.slice.call(r))},uint8clampedarray(r){return t("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(r))},int8array(r){return t("int8array:"),this.dispatch(Array.prototype.slice.call(r))},uint16array(r){return t("uint16array:"),this.dispatch(Array.prototype.slice.call(r))},int16array(r){return t("int16array:"),this.dispatch(Array.prototype.slice.call(r))},uint32array(r){return t("uint32array:"),this.dispatch(Array.prototype.slice.call(r))},int32array(r){return t("int32array:"),this.dispatch(Array.prototype.slice.call(r))},float32array(r){return t("float32array:"),this.dispatch(Array.prototype.slice.call(r))},float64array(r){return t("float64array:"),this.dispatch(Array.prototype.slice.call(r))},arraybuffer(r){return t("arraybuffer:"),this.dispatch(new Uint8Array(r))},url(r){return t("url:"+r.toString())},map(r){t("map:");const a=[...r];return this.array(a,e.unorderedSets!==!1)},set(r){t("set:");const a=[...r];return this.array(a,e.unorderedSets!==!1)},file(r){return t("file:"),this.dispatch([r.name,r.size,r.type,r.lastModfied])},blob(){if(e.ignoreUnknown)return t("[blob]");throw new Error(`Hashing Blob objects is currently not supported
Use "options.replacer" or "options.ignoreUnknown"
`)},domwindow(){return t("domwindow")},bigint(r){return t("bigint:"+r.toString())},process(){return t("process")},timer(){return t("timer")},pipe(){return t("pipe")},tcp(){return t("tcp")},udp(){return t("udp")},tty(){return t("tty")},statwatcher(){return t("statwatcher")},securecontext(){return t("securecontext")},connection(){return t("connection")},zlib(){return t("zlib")},context(){return t("context")},nodescript(){return t("nodescript")},httpparser(){return t("httpparser")},dataview(){return t("dataview")},signal(){return t("signal")},fsevent(){return t("fsevent")},tlswrap(){return t("tlswrap")}}}const F="[native code] }",G=F.length;function L(e){return typeof e!="function"?!1:Function.prototype.toString.call(e).slice(-G)===F}function X(e,i,n={}){return e===i||C(e,n)===C(i,n)}function p(e){if(typeof e!="object")return e;var i,n,t=Object.prototype.toString.call(e);if(t==="[object Object]"){if(e.constructor!==Object&&typeof e.constructor=="function"){n=new e.constructor;for(i in e)e.hasOwnProperty(i)&&n[i]!==e[i]&&(n[i]=p(e[i]))}else{n={};for(i in e)i==="__proto__"?Object.defineProperty(n,i,{value:p(e[i]),configurable:!0,enumerable:!0,writable:!0}):n[i]=p(e[i])}return n}if(t==="[object Array]"){for(i=e.length,n=Array(i);i--;)n[i]=p(e[i]);return n}return t==="[object Set]"?(n=new Set,e.forEach(function(r){n.add(p(r))}),n):t==="[object Map]"?(n=new Map,e.forEach(function(r,a){n.set(p(a),p(r))}),n):t==="[object Date]"?new Date(+e):t==="[object RegExp]"?(n=new RegExp(e.source,e.flags),n.lastIndex=e.lastIndex,n):t==="[object DataView]"?new e.constructor(p(e.buffer)):t==="[object ArrayBuffer]"?e.slice(0):t.slice(-6)==="Array]"?new e.constructor(e):e}const Y={path:"/",watch:!0,decode:e=>I(decodeURIComponent(e)),encode:e=>encodeURIComponent(typeof e=="string"?e:JSON.stringify(e))},v=window.cookieStore;function O(e,i){var u;const n={...Y,...i};n.filter??(n.filter=c=>c===e);const t=j(n)||{};let r;n.maxAge!==void 0?r=n.maxAge*1e3:n.expires&&(r=n.expires.getTime()-Date.now());const a=r!==void 0&&r<=0,o=p(a?void 0:t[e]??((u=n.default)==null?void 0:u.call(n))),s=r&&!a?W(o,r,n.watch&&n.watch!=="shallow"):A(o);{let c=null;try{!v&&typeof BroadcastChannel<"u"&&(c=new BroadcastChannel(`nuxt:cookies:${e}`))}catch{}const l=()=>{n.readonly||X(s.value,t[e])||(Q(e,s.value,n),t[e]=p(s.value),c==null||c.postMessage({value:n.encode(s.value)}))},d=h=>{var g;const m=h.refresh?(g=j(n))==null?void 0:g[e]:n.decode(h.value);f=!0,s.value=m,t[e]=p(m),B(()=>{f=!1})};let f=!1;const E=!!D();if(E&&k(()=>{f=!0,l(),c==null||c.close()}),v){const h=m=>{const g=m.changed.find(S=>S.name===e),P=m.deleted.find(S=>S.name===e);g&&d({value:g.value}),P&&d({value:null})};v.addEventListener("change",h),E&&k(()=>v.removeEventListener("change",h))}else c&&(c.onmessage=({data:h})=>d(h));n.watch?N(s,()=>{f||l()},{deep:n.watch!=="shallow"}):l()}return s}function j(e={}){return K(document.cookie,e)}function Z(e,i,n={}){return i==null?T(e,i,{...n,maxAge:-1}):T(e,i,n)}function Q(e,i,n={}){document.cookie=Z(e,i,n)}const R=2147483647;function W(e,i,n){let t,r,a=0;const o=n?A(e):{value:e};return D()&&k(()=>{r==null||r(),clearTimeout(t)}),_((s,u)=>{n&&(r=N(o,u));function c(){a=0,clearTimeout(t);const l=i-a,d=l<R?l:R;t=setTimeout(()=>{if(a+=d,a<i)return c();o.value=void 0,u()},d)}return{get(){return s(),o.value},set(l){c(),o.value=l,u()}}})}const U={"email already exists":"L'adresse e-mail est déjà utilisée.","The password field format is invalid":"Le format du champ mot de passe est invalide.","The confirmPassword field and password field must be the same":"Le champ de confirmation du mot de passe et le champ mot de passe doivent être identiques.","The username field must be defined":"Le champ nom d’utilisateur doit être défini.","The email field must be defined":"Le champ d'adresse e-mail doit être défini.","The password field must be defined":"Le champ mot de passe doit être défini.","The email field must be a valid email address":"Le champ d'adresse e-mail doit être une adresse e-mail valide.","User not found or invalid":"Utilisateur non trouvé ou invalide.","The email has already been taken":"L'adresse e-mail a déjà été prise."},y=A([]),ee=e=>{if("errors"in e&&Array.isArray(e.errors))e.errors.forEach(i=>{const n={id:Date.now()+Math.random(),...i,message:U[i.message]||i.message};y.value.push(n),setTimeout(()=>{y.value=y.value.filter(t=>t.id!==n.id)},5e3)});else if("message"in e){const i={id:Date.now()+Math.random(),message:U[e.message]||e.message};y.value=[i],setTimeout(()=>{y.value=[]},5e3)}else console.warn("Format d'erreur non supporté:",e)},te=()=>({errorMessageArray:y,addError:ee}),ne=()=>{const e=$(),i=z(),{addError:n}=te();return{sendRegister:async s=>{try{const{data:u}=await w.post(`${e.public.apiUrl}/auth/register`,s);return u}catch(u){n(u)}},sendLogin:async s=>{var u;try{const{data:c}=await w.post(`${e.public.apiUrl}/auth/login`,s);if((u=c==null?void 0:c.token)!=null&&u.token){const l=O("token",{maxAge:2592e3,path:"/",sameSite:"strict",secure:!0});return l.value=c.token,c}}catch(c){n(c)}},sendLogout:async()=>{try{const s=O("token"),{data:u}=await w.post(`${e.public.apiUrl}/auth/logout`,null,{headers:{Authorization:`Bearer  ${s}`,"Content-Type":"application/json"}});u&&await i.push("/")}catch(s){n(s)}},checkEmail:async s=>{try{const{data:u}=await w.get(`${e.public.apiUrl}/auth/verify-email/${s}`);if(u)return u}catch(u){n(u)}}}};export{te as a,ne as u};
