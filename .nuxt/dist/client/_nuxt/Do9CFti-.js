import{_ as K}from"./DpQbG3ZV.js";/* empty css        */import{u as Q}from"./B3RjkdA9.js";import{d as A,j as V,bT as W,v as Y,G as Z,l as I,r as d,g as N,a as u,w as s,b as t,e as o,c as b,h as q,t as f,u as w,f as i,F,m as ee,bX as te}from"./lwjdZeOp.js";import{I as le}from"./Cx9cfM4t.js";import{f as oe}from"./D2Ucf6zj.js";import"./CCSKKWu6.js";const se={key:0,class:"textSecondary text-14"},ae={key:1,class:"textSecondary text-14"},de={key:2,class:"textSecondary"},ne={class:"bg-bglight mt-6 pa-6 rounded-md"},ie={width:"300"},re={width:"150"},ue={width:"150"},me={class:"text-14"},ce={class:"text-end"},ve={class:"d-flex align-center justify-space-between text-14 font-weight-semibold mb-4"},pe={class:"text-16"},_e={class:"d-flex align-center justify-space-between text-14 font-weight-semibold mb-4"},fe={class:"text-16"},be={class:"d-flex align-center justify-space-between text-14 font-weight-semibold"},xe={class:"text-16"},Ve={class:"d-flex align-center justify-end ga-3"},we=.1,ge=A({__name:"Edit",setup(P){const v=Q(),x=V(!1),g=V(!0),y=W(),R=Y(),S=parseInt(R.params.id),l=V({orders:[]});Z(()=>S,async n=>{await v.fetchinvoice(),l.value=v.invoice.find(e=>e.id===n)||null,g.value=!1,l.value||y.push("/apps/invoice")},{immediate:!0});const B=["Pending","Shipped","Delivered"],m=[n=>!!n||"This field is required"],h=I(()=>{var n;return(((n=l.value)==null?void 0:n.orders)??[]).reduce((e,r)=>e+(r.unitPrice??0)*(r.units??0),0)}),T=I(()=>h.value*we),j=I(()=>h.value+T.value),E=()=>{l.value&&(l.value.orders=l.value.orders||[],l.value.orders.push({itemName:"",unitPrice:0,units:0,unitTotalPrice:0}))},z=async()=>{if(x.value&&l.value)try{await v.updateInvoice(l.value),y.push("/apps/invoice")}catch(n){console.error("Update failed:",n)}else console.log("Form is invalid or invoice not found")},L=n=>{l.value&&l.value.orders&&l.value.orders.splice(n,1)};return(n,e)=>{const r=d("v-label"),c=d("v-text-field"),p=d("v-col"),M=d("v-select"),k=d("v-row"),C=d("v-tooltip"),U=d("v-btn"),$=d("v-avatar"),G=d("RouterLink"),O=d("v-table"),X=d("v-form"),H=d("v-card-item"),J=d("v-card");return u(),N(J,{elevation:"10"},{default:s(()=>[t(H,null,{default:s(()=>[e[19]||(e[19]=o("h5",{class:"text-20 mb-7"},"Edit Invoice Details",-1)),l.value?(u(),b("p",se,"ID: "+f(l.value.id),1)):q("",!0),l.value?(u(),b("p",ae," Date: "+f(l.value.orderDate?w(oe)(new Date(l.value.orderDate),"E, MMM dd, yyyy"):"N/A"),1)):(u(),b("p",de,"Loading invoice...")),!g.value&&l.value?(u(),N(X,{key:3,ref:"formRef",modelValue:x.value,"onUpdate:modelValue":e[5]||(e[5]=a=>x.value=a),"lazy-validation":""},{default:s(()=>[o("div",ne,[t(k,null,{default:s(()=>[t(p,{cols:"12",md:"4"},{default:s(()=>[t(r,{class:"font-weight-semibold pb-2"},{default:s(()=>e[6]||(e[6]=[i("Bill From")])),_:1,__:[6]}),t(c,{"hide-details":"",modelValue:l.value.billFrom,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.billFrom=a),rules:m,required:""},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"4"},{default:s(()=>[t(r,{class:"font-weight-semibold pb-2"},{default:s(()=>e[7]||(e[7]=[i("Bill To")])),_:1,__:[7]}),t(c,{modelValue:l.value.billTo,"onUpdate:modelValue":e[1]||(e[1]=a=>l.value.billTo=a),rules:m,required:"","hide-details":""},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"4"},{default:s(()=>[t(r,{class:"font-weight-semibold pb-2"},{default:s(()=>e[8]||(e[8]=[i("Status")])),_:1,__:[8]}),t(M,{modelValue:l.value.status,"onUpdate:modelValue":e[2]||(e[2]=a=>l.value.status=a),"hide-details":"",items:B,required:""},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"6"},{default:s(()=>[t(r,{class:"font-weight-semibold pb-2"},{default:s(()=>e[9]||(e[9]=[i("From Address")])),_:1,__:[9]}),t(c,{modelValue:l.value.billFromAddress,"onUpdate:modelValue":e[3]||(e[3]=a=>l.value.billFromAddress=a),rules:m,required:"","hide-details":""},null,8,["modelValue"])]),_:1}),t(p,{cols:"12",md:"6"},{default:s(()=>[t(r,{class:"font-weight-semibold pb-2"},{default:s(()=>e[10]||(e[10]=[i("Bill To Address")])),_:1,__:[10]}),t(c,{modelValue:l.value.billToAddress,"onUpdate:modelValue":e[4]||(e[4]=a=>l.value.billToAddress=a),rules:m,required:"","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),t(O,{class:"invoice-table mt-6"},{default:s(()=>[e[13]||(e[13]=o("thead",null,[o("tr",null,[o("th",{class:"text-14 text-no-wrap"}),o("th",{class:"text-14 text-no-wrap"},"Item Name"),o("th",{class:"text-14 text-no-wrap"},"Unit Price"),o("th",{class:"text-14 text-no-wrap"},"Units"),o("th",{class:"text-14 text-no-wrap"},"Total Cost"),o("th",{class:"text-14 text-no-wrap text-end"},"Actions")])],-1)),o("tbody",null,[(u(!0),b(F,null,ee(l.value.orders,(a,D)=>(u(),b("tr",{key:D},[o("td",null,[t(U,{flat:"",icon:"",color:"lightprimary",size:"x-small",onClick:E,class:"ms-3"},{default:s(()=>[t(w(te),{class:"text-primary",size:"18"}),t(C,{activator:"parent",location:"bottom"},{default:s(()=>e[11]||(e[11]=[i("Add Item")])),_:1,__:[11]})]),_:1})]),o("td",ie,[t(c,{label:"Item Name","hide-details":"",modelValue:a.itemName,"onUpdate:modelValue":_=>a.itemName=_,rules:m,required:"",class:"py-4",width:"300"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",re,[t(c,{modelValue:a.unitPrice,"onUpdate:modelValue":_=>a.unitPrice=_,label:"Unit Price",rules:m,required:"","hide-details":"",width:"150",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",ue,[t(c,{modelValue:a.units,"onUpdate:modelValue":_=>a.units=_,label:"Units",rules:m,required:"","hide-details":"",width:"150",type:"number"},null,8,["modelValue","onUpdate:modelValue"])]),o("td",me,f(w(v).grandTotal(l.value)),1),o("td",ce,[t(G,{to:"",class:"cursor-pointer me-lg-3"},{default:s(()=>[t($,{color:"lighterror",size:"32",onClick:_=>L(D)},{default:s(()=>[t(w(le),{icon:"solar:trash-bin-minimalistic-linear",class:"text-error",height:"18"})]),_:2},1032,["onClick"]),t(C,{activator:"parent",location:"bottom"},{default:s(()=>e[12]||(e[12]=[i("Delete Invoice")])),_:1,__:[12]})]),_:2},1024)])]))),128))])]),_:1}),t(k,{class:"d-flex justify-end border-t mt-1"},{default:s(()=>[t(p,{cols:"12",md:"3",class:"mt-3 ps-lg-16"},{default:s(()=>[o("div",ve,[e[14]||(e[14]=o("p",{class:"text-muted"},"Sub Total:",-1)),o("p",pe,f(h.value),1)]),o("div",_e,[e[15]||(e[15]=o("p",{class:"text-muted"},"Vat:",-1)),o("p",fe,f(T.value),1)]),o("div",be,[e[16]||(e[16]=o("p",{class:"text-muted"},"Grand Total:",-1)),o("p",xe,f(j.value),1)])]),_:1})]),_:1}),o("div",Ve,[t(U,{flat:"",color:"success",onClick:z,rounded:"pill",class:"mt-6"},{default:s(()=>e[17]||(e[17]=[i("Save")])),_:1,__:[17]}),t(U,{flat:"",color:"error",to:"/apps/invoice",rounded:"pill",class:"mt-6"},{default:s(()=>e[18]||(e[18]=[i("Cancel")])),_:1,__:[18]})])]),_:1},8,["modelValue"])):q("",!0)]),_:1,__:[19]})]),_:1})}}}),De=A({__name:"[id]",setup(P){const v=V({title:"Edit Invoice"}),x=V([{text:"Dashboard",disabled:!1,href:"#"},{text:"Edit Invoice",disabled:!0,href:"#"}]);return(g,y)=>(u(),b(F,null,[t(K,{title:v.value.title,breadcrumbs:x.value},null,8,["title","breadcrumbs"]),t(ge)],64))}});export{De as default};
