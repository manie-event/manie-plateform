{"version":3,"file":"index-VhwgUs9c.js","sources":["../../../../components/apps/invoice/Create.vue","../../../../pages/apps/invoice/create/index.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ref, computed } from 'vue';\nimport { useInvoicestore } from '@/stores/apps/invoice';\nimport type { InvoiceType } from '@/types/apps/InvoiceTypes';\nimport { format } from 'date-fns';\nimport { Icon } from '@iconify/vue';\nimport { CirclePlusIcon } from 'vue-tabler-icons';\nimport { useRouter } from 'vue-router';\n\nconst store = useInvoicestore();\nconst valid = ref(false);\nconst router = useRouter();\n\n// Calculate the next available ID based on existing invoices\nconst nextInvoiceId = computed(() => {\n  if (store.invoice.length > 0) {\n    return Math.max(...store.invoice.map((i) => i.id)) + 1;\n  }\n  return 1;\n});\n\n// Initialize a new invoice object with the next ID\nconst invoice = ref<InvoiceType>({\n  id: nextInvoiceId.value,\n  billFrom: '',\n  billTo: '',\n  billFromAddress: '',\n  billToAddress: '',\n  totalCost: 0,\n  status: 'Pending',\n  orderDate: new Date(),\n  orders: [{ itemName: '', unitPrice: 0, units: 0, unitTotalPrice: 0 }],\n});\n\nconst statuses = ['Pending', 'Shipped', 'Delivered'];\nconst rules = [(v: any) => !!v || 'This field is required'];\nconst vatRate = 0.1;\n\n// Calculate subtotal\nconst subtotal = computed(() => {\n  return (invoice.value.orders ?? []).reduce((sum, order) => {\n    return sum + (order.unitPrice ?? 0) * (order.units ?? 0);\n  }, 0);\n});\n\n// Calculate VAT (10%)\nconst vat = computed(() => {\n  return subtotal.value * vatRate;\n});\n\n// Calculate grand total (Subtotal + VAT)\nconst grandTotal = computed(() => {\n  return subtotal.value + vat.value;\n});\n\nconst submitInvoice = () => {\n  if (valid.value) {\n    invoice.value.id = nextInvoiceId.value;\n    invoice.value.orderDate = new Date();\n    // Set totalCost to grandTotal before adding to the store\n    invoice.value.totalCost = grandTotal.value;\n    store.addInvoice(invoice.value);\n    // Navigate to the invoice list page after successful submission\n    router.push('/apps/invoice');\n  } else {\n    console.log('Form is invalid');\n  }\n};\n\nconst addOrderRow = () => {\n  invoice.value.orders = invoice.value.orders ?? [];\n  invoice.value.orders.push({\n    itemName: '',\n    unitPrice: 0,\n    units: 0,\n    unitTotalPrice: 0,\n  });\n};\n\nconst deleteOrderRow = (index: number) => {\n  invoice.value.orders = invoice.value.orders ?? [];\n  invoice.value.orders.splice(index, 1);\n};\n</script>\n\n<template>\n  <v-card elevation=\"10\">\n    <v-card-item>\n      <h5 class=\"text-20 mb-7\">Add New Invoice Details</h5>\n      <p class=\"textSecondary text-14\">ID: {{ invoice.id }}</p>\n      <p class=\"textSecondary text-14\">\n        Date:\n        {{ invoice?.orderDate ? format(new Date(invoice?.orderDate), 'E, MMM dd, yyyy') : 'N/A' }}\n      </p>\n      <!-- Display the current date -->\n\n      <v-form ref=\"formRef\" v-model=\"valid\" lazy-validation>\n        <div class=\"bg-bglight mt-6 pa-6 rounded-md\">\n          <v-row>\n            <v-col cols=\"12\" md=\"4\">\n              <v-label class=\"font-weight-semibold pb-2\">Bill From</v-label>\n              <v-text-field hide-details v-model=\"invoice.billFrom\" :rules=\"rules\" required />\n            </v-col>\n            <v-col cols=\"12\" md=\"4\">\n              <v-label class=\"font-weight-semibold pb-2\">Bill To</v-label>\n              <v-text-field v-model=\"invoice.billTo\" :rules=\"rules\" required hide-details />\n            </v-col>\n            <v-col cols=\"12\" md=\"4\">\n              <v-label class=\"font-weight-semibold pb-2\">Status</v-label>\n              <v-select\n                v-model=\"invoice.status\"\n                hide-details\n                :items=\"statuses\"\n                required\n                :disabled=\"true\"\n              />\n            </v-col>\n\n            <v-col cols=\"12\" md=\"6\">\n              <v-label class=\"font-weight-semibold pb-2\">From Address</v-label>\n              <v-text-field\n                v-model=\"invoice.billFromAddress\"\n                :rules=\"rules\"\n                required\n                hide-details\n              />\n            </v-col>\n            <v-col cols=\"12\" md=\"6\">\n              <v-label class=\"font-weight-semibold pb-2\">Bill To Address</v-label>\n              <v-text-field v-model=\"invoice.billToAddress\" :rules=\"rules\" required hide-details />\n            </v-col>\n          </v-row>\n        </div>\n\n        <v-table class=\"invoice-table mt-6\">\n          <template v-slot:default>\n            <thead>\n              <tr>\n                <th class=\"text-14 text-no-wrap\"></th>\n                <th class=\"text-14 text-no-wrap\">Item Name</th>\n                <th class=\"text-14 text-no-wrap\">Unit Price</th>\n                <th class=\"text-14 text-no-wrap\">Units</th>\n                <th class=\"text-14 text-no-wrap\">Total Cost</th>\n                <th class=\"text-14 text-no-wrap text-end\">Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(inv, index) in invoice.orders\" :key=\"index\">\n                <td class=\"text-no-wrap\">\n                  <v-btn\n                    flat\n                    icon\n                    color=\"lightprimary\"\n                    size=\"x-small\"\n                    @click=\"addOrderRow\"\n                    class=\"ms-3\"\n                  >\n                    <CirclePlusIcon class=\"text-primary\" size=\"18\" />\n                    <v-tooltip activator=\"parent\" location=\"bottom\">Add Item</v-tooltip>\n                  </v-btn>\n                </td>\n                <td width=\"300\" class=\"text-no-wrap\">\n                  <v-text-field\n                    label=\"Item Name\"\n                    hide-details\n                    v-model=\"inv.itemName\"\n                    :rules=\"rules\"\n                    required\n                    class=\"py-4\"\n                    width=\"300\"\n                  />\n                </td>\n                <td width=\"150\" class=\"text-no-wrap\">\n                  <v-text-field\n                    v-model=\"inv.unitPrice\"\n                    label=\"Unit Price\"\n                    :rules=\"rules\"\n                    required\n                    hide-details\n                    width=\"150\"\n                    type=\"number\"\n                  />\n                </td>\n                <td width=\"150\" class=\"text-no-wrap\">\n                  <v-text-field\n                    v-model=\"inv.units\"\n                    label=\"Units\"\n                    :rules=\"rules\"\n                    required\n                    hide-details\n                    width=\"150\"\n                    type=\"number\"\n                  />\n                </td>\n                <td width=\"150\" class=\"text-14 text-no-wrap\">\n                  {{ store.grandTotal(invoice) }}\n                </td>\n                <td class=\"text-end text-no-wrap\">\n                  <RouterLink to=\"\" class=\"cursor-pointer me-lg-3\">\n                    <v-avatar color=\"lighterror\" size=\"32\" @click=\"deleteOrderRow(index)\">\n                      <Icon\n                        icon=\"solar:trash-bin-minimalistic-linear\"\n                        class=\"text-error\"\n                        height=\"18\"\n                      />\n                    </v-avatar>\n                    <v-tooltip activator=\"parent\" location=\"bottom\">Delete Invoice</v-tooltip>\n                  </RouterLink>\n                </td>\n              </tr>\n            </tbody>\n          </template>\n        </v-table>\n\n        <v-row class=\"d-flex justify-end border-t mt-1\">\n          <v-col cols=\"12\" md=\"3\" class=\"mt-3 ps-lg-16\">\n            <div\n              class=\"d-flex align-center justify-space-between text-14 font-weight-semibold mb-4\"\n            >\n              <p class=\"text-muted\">Sub Total:</p>\n              <p class=\"text-16\">{{ subtotal }}</p>\n            </div>\n            <div\n              class=\"d-flex align-center justify-space-between text-14 font-weight-semibold mb-4\"\n            >\n              <p class=\"text-muted\">Vat:</p>\n              <p class=\"text-16\">{{ vat }}</p>\n            </div>\n            <div class=\"d-flex align-center justify-space-between text-14 font-weight-semibold\">\n              <p class=\"text-muted\">Grand Total:</p>\n              <p class=\"text-16\">{{ grandTotal }}</p>\n            </div>\n          </v-col>\n        </v-row>\n\n        <div class=\"d-flex align-center justify-end ga-3\">\n          <v-btn flat color=\"primary\" @click=\"submitInvoice\" class=\"mt-6\" rounded=\"pill\"\n            >Create Invoice</v-btn\n          >\n          <v-btn flat color=\"error\" to=\"/apps/invoice\" class=\"mt-6\" rounded=\"pill\">Cancel</v-btn>\n        </div>\n      </v-form>\n    </v-card-item>\n  </v-card>\n</template>\n","<script setup lang=\"ts\">\nimport { ref } from 'vue';\n// common components\nimport BaseBreadcrumb from '@/components/shared/BaseBreadcrumb.vue';\nimport CreateInvoice from '@/components/apps/invoice/Create.vue';\n\nconst page = ref({ title: 'Create Invoice' });\nconst breadcrumbs = ref([\n  {\n    text: 'Dashboard',\n    disabled: false,\n    href: '#',\n  },\n  {\n    text: 'Create Invoice',\n    disabled: true,\n    href: '#',\n  },\n]);\n</script>\n\n<template>\n  <BaseBreadcrumb :title=\"page.title\" :breadcrumbs=\"breadcrumbs\"></BaseBreadcrumb>\n  <CreateInvoice />\n</template>\n"],"names":[],"mappings":"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"}