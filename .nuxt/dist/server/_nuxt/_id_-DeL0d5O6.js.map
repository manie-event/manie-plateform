{"version":3,"file":"_id_-DeL0d5O6.js","sources":["../../../../components/apps/invoice/Edit.vue","../../../../pages/apps/invoice/edit/[id].vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ref, computed, watch } from 'vue';\nimport { useInvoicestore } from '@/stores/apps/invoice';\nimport type { InvoiceType } from '@/types/apps/InvoiceTypes';\nimport { format } from 'date-fns';\n\nimport { CirclePlusIcon } from 'vue-tabler-icons';\nimport { Icon } from '@iconify/vue';\nimport { useRoute, useRouter } from 'vue-router';\nconst store = useInvoicestore();\nconst valid = ref(false);\nconst loading = ref(true);\nconst router = useRouter();\nconst route = useRoute();\n\nconst invoiceId = parseInt(route.params.id as string);\nconst invoice = ref<InvoiceType | null>({\n  orders: [],\n});\nwatch(\n  () => invoiceId,\n  async (newId) => {\n    await store.fetchinvoice();\n    invoice.value = store.invoice.find((inv) => inv.id === newId) || null;\n    loading.value = false;\n    if (!invoice.value) {\n      router.push('/apps/invoice');\n    }\n  },\n  { immediate: true }\n);\n\nconst statuses = ['Pending', 'Shipped', 'Delivered'];\nconst rules = [(v: any) => !!v || 'This field is required'];\n// VAT percentage\nconst vatRate = 0.1;\n\nconst subtotal = computed(() => {\n  return (invoice.value?.orders ?? []).reduce((sum, order) => {\n    return sum + (order.unitPrice ?? 0) * (order.units ?? 0);\n  }, 0);\n});\n\n// Calculate VAT (10%)\nconst vat = computed(() => {\n  return subtotal.value * vatRate;\n});\n\n// Calculate grand total (Subtotal + VAT)\nconst grandTotal = computed(() => {\n  return subtotal.value + vat.value;\n});\n\nconst addOrderRow = () => {\n  if (invoice.value) {\n    invoice.value.orders = invoice.value.orders || [];\n    invoice.value.orders.push({\n      itemName: '',\n      unitPrice: 0,\n      units: 0,\n      unitTotalPrice: 0,\n    });\n  }\n};\n// Function to update invoice\nconst submitInvoice = async () => {\n  if (valid.value && invoice.value) {\n    try {\n      await store.updateInvoice(invoice.value);\n      router.push('/apps/invoice');\n    } catch (error) {\n      console.error('Update failed:', error);\n    }\n  } else {\n    console.log('Form is invalid or invoice not found');\n  }\n};\n\nconst deleteOrderRow = (index: number) => {\n  if (invoice.value && invoice.value.orders) {\n    invoice.value.orders.splice(index, 1);\n  }\n};\n</script>\n\n<template>\n  <v-card elevation=\"10\">\n    <v-card-item>\n      <h5 class=\"text-20 mb-7\">Edit Invoice Details</h5>\n      <p v-if=\"invoice\" class=\"textSecondary text-14\">ID: {{ invoice.id }}</p>\n      <p v-if=\"invoice\" class=\"textSecondary text-14\">\n        Date:\n        {{ invoice.orderDate ? format(new Date(invoice.orderDate), 'E, MMM dd, yyyy') : 'N/A' }}\n      </p>\n      <p v-else class=\"textSecondary\">Loading invoice...</p>\n\n      <v-form ref=\"formRef\" v-model=\"valid\" lazy-validation v-if=\"!loading && invoice\">\n        <div class=\"bg-bglight mt-6 pa-6 rounded-md\">\n          <v-row>\n            <v-col cols=\"12\" md=\"4\">\n              <v-label class=\"font-weight-semibold pb-2\">Bill From</v-label>\n              <v-text-field hide-details v-model=\"invoice.billFrom\" :rules=\"rules\" required />\n            </v-col>\n            <v-col cols=\"12\" md=\"4\">\n              <v-label class=\"font-weight-semibold pb-2\">Bill To</v-label>\n              <v-text-field v-model=\"invoice.billTo\" :rules=\"rules\" required hide-details />\n            </v-col>\n            <v-col cols=\"12\" md=\"4\">\n              <v-label class=\"font-weight-semibold pb-2\">Status</v-label>\n              <v-select v-model=\"invoice.status\" hide-details :items=\"statuses\" required />\n            </v-col>\n\n            <v-col cols=\"12\" md=\"6\">\n              <v-label class=\"font-weight-semibold pb-2\">From Address</v-label>\n              <v-text-field\n                v-model=\"invoice.billFromAddress\"\n                :rules=\"rules\"\n                required\n                hide-details\n              />\n            </v-col>\n            <v-col cols=\"12\" md=\"6\">\n              <v-label class=\"font-weight-semibold pb-2\">Bill To Address</v-label>\n              <v-text-field v-model=\"invoice.billToAddress\" :rules=\"rules\" required hide-details />\n            </v-col>\n          </v-row>\n        </div>\n\n        <v-table class=\"invoice-table mt-6\">\n          <template v-slot:default>\n            <thead>\n              <tr>\n                <th class=\"text-14 text-no-wrap\"></th>\n                <th class=\"text-14 text-no-wrap\">Item Name</th>\n                <th class=\"text-14 text-no-wrap\">Unit Price</th>\n                <th class=\"text-14 text-no-wrap\">Units</th>\n                <th class=\"text-14 text-no-wrap\">Total Cost</th>\n                <th class=\"text-14 text-no-wrap text-end\">Actions</th>\n              </tr>\n            </thead>\n            <tbody>\n              <tr v-for=\"(inv, index) in invoice.orders\" :key=\"index\">\n                <td>\n                  <v-btn\n                    flat\n                    icon\n                    color=\"lightprimary\"\n                    size=\"x-small\"\n                    @click=\"addOrderRow\"\n                    class=\"ms-3\"\n                  >\n                    <CirclePlusIcon class=\"text-primary\" size=\"18\" />\n                    <v-tooltip activator=\"parent\" location=\"bottom\">Add Item</v-tooltip>\n                  </v-btn>\n                </td>\n                <td width=\"300\">\n                  <v-text-field\n                    label=\"Item Name\"\n                    hide-details\n                    v-model=\"inv.itemName\"\n                    :rules=\"rules\"\n                    required\n                    class=\"py-4\"\n                    width=\"300\"\n                  />\n                </td>\n                <td width=\"150\">\n                  <v-text-field\n                    v-model=\"inv.unitPrice\"\n                    label=\"Unit Price\"\n                    :rules=\"rules\"\n                    required\n                    hide-details\n                    width=\"150\"\n                    type=\"number\"\n                  />\n                </td>\n                <td width=\"150\">\n                  <v-text-field\n                    v-model=\"inv.units\"\n                    label=\"Units\"\n                    :rules=\"rules\"\n                    required\n                    hide-details\n                    width=\"150\"\n                    type=\"number\"\n                  />\n                </td>\n                <td class=\"text-14\">\n                  {{ store.grandTotal(invoice) }}\n                </td>\n                <td class=\"text-end\">\n                  <RouterLink to=\"\" class=\"cursor-pointer me-lg-3\">\n                    <v-avatar color=\"lighterror\" size=\"32\" @click=\"deleteOrderRow(index)\">\n                      <Icon\n                        icon=\"solar:trash-bin-minimalistic-linear\"\n                        class=\"text-error\"\n                        height=\"18\"\n                      />\n                    </v-avatar>\n                    <v-tooltip activator=\"parent\" location=\"bottom\">Delete Invoice</v-tooltip>\n                  </RouterLink>\n                </td>\n              </tr>\n            </tbody>\n          </template>\n        </v-table>\n\n        <v-row class=\"d-flex justify-end border-t mt-1\">\n          <v-col cols=\"12\" md=\"3\" class=\"mt-3 ps-lg-16\">\n            <div\n              class=\"d-flex align-center justify-space-between text-14 font-weight-semibold mb-4\"\n            >\n              <p class=\"text-muted\">Sub Total:</p>\n              <p class=\"text-16\">{{ subtotal }}</p>\n            </div>\n            <div\n              class=\"d-flex align-center justify-space-between text-14 font-weight-semibold mb-4\"\n            >\n              <p class=\"text-muted\">Vat:</p>\n              <p class=\"text-16\">{{ vat }}</p>\n            </div>\n            <div class=\"d-flex align-center justify-space-between text-14 font-weight-semibold\">\n              <p class=\"text-muted\">Grand Total:</p>\n              <p class=\"text-16\">{{ grandTotal }}</p>\n            </div>\n          </v-col>\n        </v-row>\n\n        <div class=\"d-flex align-center justify-end ga-3\">\n          <v-btn flat color=\"success\" @click=\"submitInvoice\" rounded=\"pill\" class=\"mt-6\"\n            >Save</v-btn\n          >\n          <v-btn flat color=\"error\" to=\"/apps/invoice\" rounded=\"pill\" class=\"mt-6\">Cancel</v-btn>\n        </div>\n      </v-form>\n    </v-card-item>\n  </v-card>\n</template>\n","<script setup lang=\"ts\">\nimport { ref } from 'vue';\n// common components\nimport BaseBreadcrumb from '@/components/shared/BaseBreadcrumb.vue';\nimport EditInvoice from '@/components/apps/invoice/Edit.vue';\n\nconst page = ref({ title: 'Edit Invoice' });\nconst breadcrumbs = ref([\n  {\n    text: 'Dashboard',\n    disabled: false,\n    href: '#',\n  },\n  {\n    text: 'Edit Invoice',\n    disabled: true,\n    href: '#',\n  },\n]);\n</script>\n\n<template>\n  <BaseBreadcrumb :title=\"page.title\" :breadcrumbs=\"breadcrumbs\"></BaseBreadcrumb>\n  <EditInvoice />\n</template>\n"],"names":[],"mappings":"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"}